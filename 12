ZGlmZiAtLWdpdCBhL3NhbHQvY2FjaGUvX19pbml0X18ucHkgYi9zYWx0L2NhY2hlL19faW5pdF9f
LnB5CmluZGV4IDY4ZmZjZGMuLmJmOTcxMTIgMTAwNjQ0Ci0tLSBhL3NhbHQvY2FjaGUvX19pbml0
X18ucHkKKysrIGIvc2FsdC9jYWNoZS9fX2luaXRfXy5weQpAQCAtNiwxMiArNiwxMSBAQCBMb2Fk
ZXIgbWVjaGFuaXNtIGZvciBjYWNoaW5nIGRhdGEsIHdpdGggZGF0YSBleHBpcmF0aW9uLCBldGMu
CiAnJycKIAogIyBJbXBvcnQgUHl0aG9uIGxpYnMKLWZyb20gX19mdXR1cmVfXyBpbXBvcnQgYWJz
b2x1dGVfaW1wb3J0LCBwcmludF9mdW5jdGlvbiwgdW5pY29kZV9saXRlcmFscworZnJvbSBfX2Z1
dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQKIGltcG9ydCBsb2dnaW5nCiBpbXBvcnQgdGlt
ZQogCi0jIEltcG9ydCBTYWx0IGxpYnMKLWltcG9ydCBzYWx0LmNvbmZpZworIyBJbXBvcnQgU2Fs
dCBsb2JzCiBmcm9tIHNhbHQuZXh0IGltcG9ydCBzaXgKIGZyb20gc2FsdC5wYXlsb2FkIGltcG9y
dCBTZXJpYWwKIGZyb20gc2FsdC51dGlscy5vZGljdCBpbXBvcnQgT3JkZXJlZERpY3QKQEAgLTY3
LDE3ICs2NiwxMiBAQCBjbGFzcyBDYWNoZShvYmplY3QpOgogICAgIEtleSBuYW1lIGlzIGEgc3Ry
aW5nIGlkZW50aWZpZXIgb2YgYSBkYXRhIGNvbnRhaW5lciAobGlrZSBhIGZpbGUgaW5zaWRlIGEK
ICAgICBkaXJlY3RvcnkpIHdoaWNoIHdpbGwgaG9sZCB0aGUgZGF0YS4KICAgICAnJycKLSAgICBk
ZWYgX19pbml0X18oc2VsZiwgb3B0cywgY2FjaGVkaXI9Tm9uZSwgKiprd2FyZ3MpOgorICAgIGRl
ZiBfX2luaXRfXyhzZWxmLCBvcHRzLCAqKmt3YXJncyk6CiAgICAgICAgIHNlbGYub3B0cyA9IG9w
dHMKLSAgICAgICAgaWYgY2FjaGVkaXIgaXMgTm9uZToKLSAgICAgICAgICAgIHNlbGYuY2FjaGVk
aXIgPSBvcHRzLmdldCgnY2FjaGVkaXInLCBzYWx0LnN5c3BhdGhzLkNBQ0hFX0RJUikKLSAgICAg
ICAgZWxzZToKLSAgICAgICAgICAgIHNlbGYuY2FjaGVkaXIgPSBjYWNoZWRpcgotICAgICAgICBz
ZWxmLmRyaXZlciA9IG9wdHMuZ2V0KCdjYWNoZScsIHNhbHQuY29uZmlnLkRFRkFVTFRfTUFTVEVS
X09QVFNbJ2NhY2hlJ10pCisgICAgICAgIHNlbGYuZHJpdmVyID0gb3B0c1snY2FjaGUnXQogICAg
ICAgICBzZWxmLnNlcmlhbCA9IFNlcmlhbChvcHRzKQogICAgICAgICBzZWxmLl9tb2R1bGVzID0g
Tm9uZQogICAgICAgICBzZWxmLl9rd2FyZ3MgPSBrd2FyZ3MKLSAgICAgICAgc2VsZi5fa3dhcmdz
WydjYWNoZWRpciddID0gc2VsZi5jYWNoZWRpcgogCiAgICAgZGVmIF9fbGF6eV9pbml0KHNlbGYp
OgogICAgICAgICBzZWxmLl9tb2R1bGVzID0gc2FsdC5sb2FkZXIuY2FjaGUoc2VsZi5vcHRzLCBz
ZWxmLnNlcmlhbCkKQEAgLTIyNCw3ICsyMTgsNyBAQCBjbGFzcyBDYWNoZShvYmplY3QpOgogICAg
ICAgICBmdW4gPSAnezB9LmZsdXNoJy5mb3JtYXQoc2VsZi5kcml2ZXIpCiAgICAgICAgIHJldHVy
biBzZWxmLm1vZHVsZXNbZnVuXShiYW5rLCBrZXk9a2V5LCAqKnNlbGYuX2t3YXJncykKIAotICAg
IGRlZiBsaXN0KHNlbGYsIGJhbmspOgorICAgIGRlZiBscyhzZWxmLCBiYW5rKToKICAgICAgICAg
JycnCiAgICAgICAgIExpc3RzIGVudHJpZXMgc3RvcmVkIGluIHRoZSBzcGVjaWZpZWQgYmFuay4K
IApAQCAtMjQwLDkgKzIzNCwxMSBAQCBjbGFzcyBDYWNoZShvYmplY3QpOgogICAgICAgICAgICAg
UmFpc2VzIGFuIGV4Y2VwdGlvbiBpZiBjYWNoZSBkcml2ZXIgZGV0ZWN0ZWQgYW4gZXJyb3IgYWNj
ZXNzaW5nIGRhdGEKICAgICAgICAgICAgIGluIHRoZSBjYWNoZSBiYWNrZW5kIChhdXRoLCBwZXJt
aXNzaW9ucywgZXRjKS4KICAgICAgICAgJycnCi0gICAgICAgIGZ1biA9ICd7MH0ubGlzdCcuZm9y
bWF0KHNlbGYuZHJpdmVyKQorICAgICAgICBmdW4gPSAnezB9LmxzJy5mb3JtYXQoc2VsZi5kcml2
ZXIpCiAgICAgICAgIHJldHVybiBzZWxmLm1vZHVsZXNbZnVuXShiYW5rLCAqKnNlbGYuX2t3YXJn
cykKIAorICAgIGxpc3QgPSBscworCiAgICAgZGVmIGNvbnRhaW5zKHNlbGYsIGJhbmssIGtleT1O
b25lKToKICAgICAgICAgJycnCiAgICAgICAgIENoZWNrcyBpZiB0aGUgc3BlY2lmaWVkIGJhbmsg
Y29udGFpbnMgdGhlIHNwZWNpZmllZCBrZXkuCkBAIC0zMjMsMTAgKzMxOSwxMCBAQCBjbGFzcyBN
ZW1DYWNoZShDYWNoZSk6CiAgICAgICAgIGlmIHJlY29yZCBpcyBub3QgTm9uZSBhbmQgcmVjb3Jk
WzBdICsgc2VsZi5leHBpcmUgPj0gbm93OgogICAgICAgICAgICAgaWYgc2VsZi5kZWJ1ZzoKICAg
ICAgICAgICAgICAgICBzZWxmLmhpdCArPSAxCi0gICAgICAgICAgICAgICAgbG9nLmRlYnVnKAot
ICAgICAgICAgICAgICAgICAgICAnTWVtQ2FjaGUgc3RhdHMgKGNhbGwvaGl0L3JhdGUpOiAlcy8l
cy8lcycsCi0gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsbCwgc2VsZi5oaXQsIGZsb2F0KHNl
bGYuaGl0KSAvIHNlbGYuY2FsbAotICAgICAgICAgICAgICAgICkKKyAgICAgICAgICAgICAgICBs
b2cuZGVidWcoJ01lbUNhY2hlIHN0YXRzIChjYWxsL2hpdC9yYXRlKTogJworICAgICAgICAgICAg
ICAgICAgICAgICAgICAnezB9L3sxfS97Mn0nLmZvcm1hdChzZWxmLmNhbGwsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaGl0LAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9hdChzZWxmLmhpdCkgLyBz
ZWxmLmNhbGwpKQogICAgICAgICAgICAgIyB1cGRhdGUgYXRpbWUgYW5kIHJldHVybgogICAgICAg
ICAgICAgcmVjb3JkWzBdID0gbm93CiAgICAgICAgICAgICBzZWxmLnN0b3JhZ2VbKGJhbmssIGtl
eSldID0gcmVjb3JkCmRpZmYgLS1naXQgYS9zYWx0L2NhY2hlL2NvbnN1bC5weSBiL3NhbHQvY2Fj
aGUvY29uc3VsLnB5CmluZGV4IDJmOGU4NzguLjAxNDhjNzMgMTAwNjQ0Ci0tLSBhL3NhbHQvY2Fj
aGUvY29uc3VsLnB5CisrKyBiL3NhbHQvY2FjaGUvY29uc3VsLnB5CkBAIC00Niw3ICs0Niw3IEBA
IHZhbHVlIHRvIGBgY29uc3VsYGA6CiAuLiBfYHB5dGhvbi1jb25zdWwgZG9jdW1lbnRhdGlvbmA6
IGh0dHBzOi8vcHl0aG9uLWNvbnN1bC5yZWFkdGhlZG9jcy5pby9lbi9sYXRlc3QvI2NvbnN1bAog
CiAnJycKLWZyb20gX19mdXR1cmVfXyBpbXBvcnQgYWJzb2x1dGVfaW1wb3J0LCBwcmludF9mdW5j
dGlvbiwgdW5pY29kZV9saXRlcmFscworZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9p
bXBvcnQKIGltcG9ydCBsb2dnaW5nCiB0cnk6CiAgICAgaW1wb3J0IGNvbnN1bApAQCAtNjMsNyAr
NjMsNyBAQCBhcGkgPSBOb25lCiAjIERlZmluZSB0aGUgbW9kdWxlJ3MgdmlydHVhbCBuYW1lCiBf
X3ZpcnR1YWxuYW1lX18gPSAnY29uc3VsJwogCi1fX2Z1bmNfYWxpYXNfXyA9IHsnbGlzdF8nOiAn
bGlzdCd9CitfX2Z1bmNfYWxpYXNfXyA9IHsnbGlzdCc6ICdscyd9CiAKIAogZGVmIF9fdmlydHVh
bF9fKCk6CkBAIC0xNDQsNyArMTQ0LDcgQEAgZGVmIGZsdXNoKGJhbmssIGtleT1Ob25lKToKICAg
ICAgICAgKQogCiAKLWRlZiBsaXN0XyhiYW5rKToKK2RlZiBscyhiYW5rKToKICAgICAnJycKICAg
ICBSZXR1cm4gYW4gaXRlcmFibGUgb2JqZWN0IGNvbnRhaW5pbmcgYWxsIGVudHJpZXMgc3RvcmVk
IGluIHRoZSBzcGVjaWZpZWQgYmFuay4KICAgICAnJycKZGlmZiAtLWdpdCBhL3NhbHQvZGFlbW9u
cy9tYXN0ZXJhcGkucHkgYi9zYWx0L2RhZW1vbnMvbWFzdGVyYXBpLnB5CmluZGV4IGQxMzQwMGQu
LmNjYjUwMjcgMTAwNjQ0Ci0tLSBhL3NhbHQvZGFlbW9ucy9tYXN0ZXJhcGkucHkKKysrIGIvc2Fs
dC9kYWVtb25zL21hc3RlcmFwaS5weQpAQCAtMyw3ICszLDcgQEAKIFRoaXMgbW9kdWxlIGNvbnRh
aW5zIGFsbCBvZiB0aGUgcm91dGluZXMgbmVlZGVkIHRvIHNldCB1cCBhIG1hc3RlciBzZXJ2ZXIs
IHRoaXMKIGludm9sdmVzIHByZXBhcmluZyB0aGUgdGhyZWUgbGlzdGVuZXJzIGFuZCB0aGUgd29y
a2VycyBuZWVkZWQgYnkgdGhlIG1hc3Rlci4KICcnJwotZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBh
YnNvbHV0ZV9pbXBvcnQsIHByaW50X2Z1bmN0aW9uLCB1bmljb2RlX2xpdGVyYWxzCitmcm9tIF9f
ZnV0dXJlX18gaW1wb3J0IGFic29sdXRlX2ltcG9ydAogCiAjIEltcG9ydCBweXRob24gbGlicwog
aW1wb3J0IGZubWF0Y2gKQEAgLTEyLDEzICsxMiwxMyBAQCBpbXBvcnQgb3MKIGltcG9ydCByZQog
aW1wb3J0IHRpbWUKIGltcG9ydCBzdGF0CitpbXBvcnQgbXNncGFjawogCiAjIEltcG9ydCBzYWx0
IGxpYnMKLWltcG9ydCBzYWx0LmFjbAogaW1wb3J0IHNhbHQuY3J5cHQKK2ltcG9ydCBzYWx0LnV0
aWxzCiBpbXBvcnQgc2FsdC5jYWNoZQogaW1wb3J0IHNhbHQuY2xpZW50Ci1pbXBvcnQgc2FsdC5l
eGNlcHRpb25zCiBpbXBvcnQgc2FsdC5wYXlsb2FkCiBpbXBvcnQgc2FsdC5waWxsYXIKIGltcG9y
dCBzYWx0LnN0YXRlCkBAIC0yNiwzMCArMjYsMjEgQEAgaW1wb3J0IHNhbHQucnVubmVyCiBpbXBv
cnQgc2FsdC5hdXRoCiBpbXBvcnQgc2FsdC53aGVlbAogaW1wb3J0IHNhbHQubWluaW9uCitpbXBv
cnQgc2FsdC5zZWFyY2gKIGltcG9ydCBzYWx0LmtleQogaW1wb3J0IHNhbHQuZmlsZXNlcnZlcgot
aW1wb3J0IHNhbHQudXRpbHMuYXJncwogaW1wb3J0IHNhbHQudXRpbHMuYXRvbWljZmlsZQotaW1w
b3J0IHNhbHQudXRpbHMuZGljdHVwZGF0ZQogaW1wb3J0IHNhbHQudXRpbHMuZXZlbnQKLWltcG9y
dCBzYWx0LnV0aWxzLmZpbGVzCi1pbXBvcnQgc2FsdC51dGlscy5naXRmcwogaW1wb3J0IHNhbHQu
dXRpbHMudmVyaWZ5CiBpbXBvcnQgc2FsdC51dGlscy5taW5pb25zCiBpbXBvcnQgc2FsdC51dGls
cy5nemlwX3V0aWwKIGltcG9ydCBzYWx0LnV0aWxzLmppZAotaW1wb3J0IHNhbHQudXRpbHMubWlu
aW9ucwotaW1wb3J0IHNhbHQudXRpbHMucGF0aAotaW1wb3J0IHNhbHQudXRpbHMucGxhdGZvcm0K
LWltcG9ydCBzYWx0LnV0aWxzLnN0cmluZ3V0aWxzCi1pbXBvcnQgc2FsdC51dGlscy51c2VyCi1p
bXBvcnQgc2FsdC51dGlscy52ZXJpZnkKLWltcG9ydCBzYWx0LnV0aWxzLnZlcnNpb25zCi1mcm9t
IHNhbHQuZGVmYXVsdHMgaW1wb3J0IERFRkFVTFRfVEFSR0VUX0RFTElNCiBmcm9tIHNhbHQucGls
bGFyIGltcG9ydCBnaXRfcGlsbGFyCitmcm9tIHNhbHQudXRpbHMuZXZlbnQgaW1wb3J0IHRhZ2lm
eQorZnJvbSBzYWx0LmV4Y2VwdGlvbnMgaW1wb3J0IFNhbHRNYXN0ZXJFcnJvcgogCiAjIEltcG9y
dCAzcmQtcGFydHkgbGlicwotZnJvbSBzYWx0LmV4dCBpbXBvcnQgc2l4CitpbXBvcnQgc2FsdC5l
eHQuc2l4IGFzIHNpeAogCiB0cnk6CiAgICAgaW1wb3J0IHB3ZApAQCAtNzEsMTkgKzYyLDM4IEBA
IGRlZiBpbml0X2dpdF9waWxsYXIob3B0cyk6CiAgICAgcmV0ID0gW10KICAgICBmb3Igb3B0c19k
aWN0IGluIFt4IGZvciB4IGluIG9wdHMuZ2V0KCdleHRfcGlsbGFyJywgW10pXToKICAgICAgICAg
aWYgJ2dpdCcgaW4gb3B0c19kaWN0OgotICAgICAgICAgICAgdHJ5OgotICAgICAgICAgICAgICAg
IHBpbGxhciA9IHNhbHQudXRpbHMuZ2l0ZnMuR2l0UGlsbGFyKAotICAgICAgICAgICAgICAgICAg
ICBvcHRzLAorICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShvcHRzX2RpY3RbJ2dpdCddLCBzaXgu
c3RyaW5nX3R5cGVzKToKKyAgICAgICAgICAgICAgICAjIExlZ2FjeSBnaXQgcGlsbGFyIGNvZGUK
KyAgICAgICAgICAgICAgICB0cnk6CisgICAgICAgICAgICAgICAgICAgIGltcG9ydCBnaXQKKyAg
ICAgICAgICAgICAgICBleGNlcHQgSW1wb3J0RXJyb3I6CisgICAgICAgICAgICAgICAgICAgIHJl
dHVybiByZXQKKyAgICAgICAgICAgICAgICBwYXJ0cyA9IG9wdHNfZGljdFsnZ2l0J10uc3RyaXAo
KS5zcGxpdCgpCisgICAgICAgICAgICAgICAgdHJ5OgorICAgICAgICAgICAgICAgICAgICBiciA9
IHBhcnRzWzBdCisgICAgICAgICAgICAgICAgICAgIGxvYyA9IHBhcnRzWzFdCisgICAgICAgICAg
ICAgICAgZXhjZXB0IEluZGV4RXJyb3I6CisgICAgICAgICAgICAgICAgICAgIGxvZy5jcml0aWNh
bCgKKyAgICAgICAgICAgICAgICAgICAgICAgICdVbmFibGUgdG8gZXh0cmFjdCBleHRlcm5hbCBw
aWxsYXIgZGF0YTogezB9JworICAgICAgICAgICAgICAgICAgICAgICAgLmZvcm1hdChvcHRzX2Rp
Y3RbJ2dpdCddKQorICAgICAgICAgICAgICAgICAgICApCisgICAgICAgICAgICAgICAgZWxzZToK
KyAgICAgICAgICAgICAgICAgICAgcmV0LmFwcGVuZCgKKyAgICAgICAgICAgICAgICAgICAgICAg
IGdpdF9waWxsYXIuX0xlZ2FjeUdpdFBpbGxhcigKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBiciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2MsCisgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgb3B0cworICAgICAgICAgICAgICAgICAgICAgICAgKQorICAgICAgICAgICAg
ICAgICAgICApCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAgICAgICAgICMgTmV3IGdpdF9w
aWxsYXIgY29kZQorICAgICAgICAgICAgICAgIHBpbGxhciA9IHNhbHQudXRpbHMuZ2l0ZnMuR2l0
UGlsbGFyKG9wdHMpCisgICAgICAgICAgICAgICAgcGlsbGFyLmluaXRfcmVtb3RlcygKICAgICAg
ICAgICAgICAgICAgICAgb3B0c19kaWN0WydnaXQnXSwKLSAgICAgICAgICAgICAgICAgICAgcGVy
X3JlbW90ZV9vdmVycmlkZXM9Z2l0X3BpbGxhci5QRVJfUkVNT1RFX09WRVJSSURFUywKLSAgICAg
ICAgICAgICAgICAgICAgcGVyX3JlbW90ZV9vbmx5PWdpdF9waWxsYXIuUEVSX1JFTU9URV9PTkxZ
LAotICAgICAgICAgICAgICAgICAgICBnbG9iYWxfb25seT1naXRfcGlsbGFyLkdMT0JBTF9PTkxZ
KQorICAgICAgICAgICAgICAgICAgICBnaXRfcGlsbGFyLlBFUl9SRU1PVEVfT1ZFUlJJREVTLAor
ICAgICAgICAgICAgICAgICAgICBnaXRfcGlsbGFyLlBFUl9SRU1PVEVfT05MWQorICAgICAgICAg
ICAgICAgICkKICAgICAgICAgICAgICAgICByZXQuYXBwZW5kKHBpbGxhcikKLSAgICAgICAgICAg
IGV4Y2VwdCBzYWx0LmV4Y2VwdGlvbnMuRmlsZXNlcnZlckNvbmZpZ0Vycm9yOgotICAgICAgICAg
ICAgICAgIGlmIG9wdHMuZ2V0KCdnaXRfcGlsbGFyX3ZlcmlmeV9jb25maWcnLCBUcnVlKToKLSAg
ICAgICAgICAgICAgICAgICAgcmFpc2UKLSAgICAgICAgICAgICAgICBlbHNlOgotICAgICAgICAg
ICAgICAgICAgICBsb2cuY3JpdGljYWwoJ0NvdWxkIG5vdCBpbml0aWFsaXplIGdpdF9waWxsYXIn
KQogICAgIHJldHVybiByZXQKIAogCkBAIC0xMDAsMTMgKzExMCwxMyBAQCBkZWYgY2xlYW5fZnNi
YWNrZW5kKG9wdHMpOgogICAgICAgICAgICAgICAgICdlbnZzLnAnCiAgICAgICAgICAgICApCiAg
ICAgICAgICAgICBpZiBvcy5wYXRoLmlzZmlsZShlbnZfY2FjaGUpOgotICAgICAgICAgICAgICAg
IGxvZy5kZWJ1ZygnQ2xlYXJpbmcgJXNmcyBlbnYgY2FjaGUnLCBiYWNrZW5kKQorICAgICAgICAg
ICAgICAgIGxvZy5kZWJ1ZygnQ2xlYXJpbmcgezB9ZnMgZW52IGNhY2hlJy5mb3JtYXQoYmFja2Vu
ZCkpCiAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUo
ZW52X2NhY2hlKQogICAgICAgICAgICAgICAgIGV4Y2VwdCBPU0Vycm9yIGFzIGV4YzoKICAgICAg
ICAgICAgICAgICAgICAgbG9nLmNyaXRpY2FsKAotICAgICAgICAgICAgICAgICAgICAgICAgJ1Vu
YWJsZSB0byBjbGVhciBlbnYgY2FjaGUgZmlsZSAlczogJXMnLAotICAgICAgICAgICAgICAgICAg
ICAgICAgZW52X2NhY2hlLCBleGMKKyAgICAgICAgICAgICAgICAgICAgICAgICdVbmFibGUgdG8g
Y2xlYXIgZW52IGNhY2hlIGZpbGUgezB9OiB7MX0nCisgICAgICAgICAgICAgICAgICAgICAgICAu
Zm9ybWF0KGVudl9jYWNoZSwgZXhjKQogICAgICAgICAgICAgICAgICAgICApCiAKICAgICAgICAg
ICAgIGZpbGVfbGlzdHNfZGlyID0gb3MucGF0aC5qb2luKApAQCAtMTI0LDggKzEzNCw4IEBAIGRl
ZiBjbGVhbl9mc2JhY2tlbmQob3B0cyk6CiAgICAgICAgICAgICAgICAgICAgIG9zLnJlbW92ZShj
YWNoZV9maWxlKQogICAgICAgICAgICAgICAgIGV4Y2VwdCBPU0Vycm9yIGFzIGV4YzoKICAgICAg
ICAgICAgICAgICAgICAgbG9nLmNyaXRpY2FsKAotICAgICAgICAgICAgICAgICAgICAgICAgJ1Vu
YWJsZSB0byBmaWxlX2xpc3RzIGNhY2hlIGZpbGUgJXM6ICVzJywKLSAgICAgICAgICAgICAgICAg
ICAgICAgIGNhY2hlX2ZpbGUsIGV4YworICAgICAgICAgICAgICAgICAgICAgICAgJ1VuYWJsZSB0
byBmaWxlX2xpc3RzIGNhY2hlIGZpbGUgezB9OiB7MX0nCisgICAgICAgICAgICAgICAgICAgICAg
ICAuZm9ybWF0KGNhY2hlX2ZpbGUsIGV4YykKICAgICAgICAgICAgICAgICAgICAgKQogCiAKQEAg
LTEzMywxMSArMTQzLDIyIEBAIGRlZiBjbGVhbl9leHBpcmVkX3Rva2VucyhvcHRzKToKICAgICAn
JycKICAgICBDbGVhbiBleHBpcmVkIHRva2VucyBmcm9tIHRoZSBtYXN0ZXIKICAgICAnJycKLSAg
ICBsb2FkYXV0aCA9IHNhbHQuYXV0aC5Mb2FkQXV0aChvcHRzKQotICAgIGZvciB0b2sgaW4gbG9h
ZGF1dGgubGlzdF90b2tlbnMoKToKLSAgICAgICAgdG9rZW5fZGF0YSA9IGxvYWRhdXRoLmdldF90
b2sodG9rKQotICAgICAgICBpZiAnZXhwaXJlJyBub3QgaW4gdG9rZW5fZGF0YSBvciB0b2tlbl9k
YXRhLmdldCgnZXhwaXJlJywgMCkgPCB0aW1lLnRpbWUoKToKLSAgICAgICAgICAgIGxvYWRhdXRo
LnJtX3Rva2VuKHRvaykKKyAgICBzZXJpYWxpemVyID0gc2FsdC5wYXlsb2FkLlNlcmlhbChvcHRz
KQorICAgIGZvciAoZGlycGF0aCwgZGlybmFtZXMsIGZpbGVuYW1lcykgaW4gb3Mud2FsayhvcHRz
Wyd0b2tlbl9kaXInXSk6CisgICAgICAgIGZvciB0b2tlbiBpbiBmaWxlbmFtZXM6CisgICAgICAg
ICAgICB0b2tlbl9wYXRoID0gb3MucGF0aC5qb2luKGRpcnBhdGgsIHRva2VuKQorICAgICAgICAg
ICAgd2l0aCBzYWx0LnV0aWxzLmZvcGVuKHRva2VuX3BhdGgpIGFzIHRva2VuX2ZpbGU6CisgICAg
ICAgICAgICAgICAgdHJ5OgorICAgICAgICAgICAgICAgICAgICB0b2tlbl9kYXRhID0gc2VyaWFs
aXplci5sb2Fkcyh0b2tlbl9maWxlLnJlYWQoKSkKKyAgICAgICAgICAgICAgICBleGNlcHQgbXNn
cGFjay5VbnBhY2tWYWx1ZUVycm9yOgorICAgICAgICAgICAgICAgICAgICAjIEJhZCB0b2tlbiBm
aWxlIG9yIGVtcHR5LiBSZW1vdmUuCisgICAgICAgICAgICAgICAgICAgIG9zLnJlbW92ZSh0b2tl
bl9wYXRoKQorICAgICAgICAgICAgICAgICAgICByZXR1cm4KKyAgICAgICAgICAgICAgICBpZiAn
ZXhwaXJlJyBub3QgaW4gdG9rZW5fZGF0YSBvciB0b2tlbl9kYXRhLmdldCgnZXhwaXJlJywgMCkg
PCB0aW1lLnRpbWUoKToKKyAgICAgICAgICAgICAgICAgICAgdHJ5OgorICAgICAgICAgICAgICAg
ICAgICAgICAgb3MucmVtb3ZlKHRva2VuX3BhdGgpCisgICAgICAgICAgICAgICAgICAgIGV4Y2Vw
dCAoSU9FcnJvciwgT1NFcnJvcik6CisgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAKIAog
ZGVmIGNsZWFuX3B1Yl9hdXRoKG9wdHMpOgpAQCAtMTQ2LDEzICsxNjcsMTIgQEAgZGVmIGNsZWFu
X3B1Yl9hdXRoKG9wdHMpOgogICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoYXV0aF9jYWNo
ZSk6CiAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgZWxzZToKLSAgICAgICAgICAgIGZvciAo
ZGlycGF0aCwgZGlybmFtZXMsIGZpbGVuYW1lcykgaW4gc2FsdC51dGlscy5wYXRoLm9zX3dhbGso
YXV0aF9jYWNoZSk6CisgICAgICAgICAgICBmb3IgKGRpcnBhdGgsIGRpcm5hbWVzLCBmaWxlbmFt
ZXMpIGluIG9zLndhbGsoYXV0aF9jYWNoZSk6CiAgICAgICAgICAgICAgICAgZm9yIGF1dGhfZmls
ZSBpbiBmaWxlbmFtZXM6CiAgICAgICAgICAgICAgICAgICAgIGF1dGhfZmlsZV9wYXRoID0gb3Mu
cGF0aC5qb2luKGRpcnBhdGgsIGF1dGhfZmlsZSkKICAgICAgICAgICAgICAgICAgICAgaWYgbm90
IG9zLnBhdGguaXNmaWxlKGF1dGhfZmlsZV9wYXRoKToKICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnRpbnVlCi0gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lLnRpbWUoKSAtIG9zLnBhdGgu
Z2V0bXRpbWUoYXV0aF9maWxlX3BhdGgpID4KLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAo
b3B0c1sna2VlcF9qb2JzJ10gKiAzNjAwKSk6CisgICAgICAgICAgICAgICAgICAgIGlmIG9zLnBh
dGguZ2V0bXRpbWUoYXV0aF9maWxlX3BhdGgpIC0gdGltZS50aW1lKCkgPiBvcHRzWydrZWVwX2pv
YnMnXToKICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnJlbW92ZShhdXRoX2ZpbGVfcGF0aCkK
ICAgICBleGNlcHQgKElPRXJyb3IsIE9TRXJyb3IpOgogICAgICAgICBsb2cuZXJyb3IoJ1VuYWJs
ZSB0byBkZWxldGUgcHViIGF1dGggZmlsZScpCkBAIC0xNzUsMTUgKzE5NSw3IEBAIGRlZiBjbGVh
bl9vbGRfam9icyhvcHRzKToKIAogCiBkZWYgbWtfa2V5KG9wdHMsIHVzZXIpOgotICAgIGlmIEhB
U19QV0Q6Ci0gICAgICAgIHVpZCA9IE5vbmUKLSAgICAgICAgdHJ5OgotICAgICAgICAgICAgdWlk
ID0gcHdkLmdldHB3bmFtKHVzZXIpLnB3X3VpZAotICAgICAgICBleGNlcHQgS2V5RXJyb3I6Ci0g
ICAgICAgICAgICAjIFVzZXIgZG9lc24ndCBleGlzdCBpbiB0aGUgc3lzdGVtCi0gICAgICAgICAg
ICBpZiBvcHRzWydjbGllbnRfYWNsX3ZlcmlmeSddOgotICAgICAgICAgICAgICAgIHJldHVybiBO
b25lCi0gICAgaWYgc2FsdC51dGlscy5wbGF0Zm9ybS5pc193aW5kb3dzKCk6CisgICAgaWYgc2Fs
dC51dGlscy5pc193aW5kb3dzKCk6CiAgICAgICAgICMgVGhlIHVzZXJuYW1lIG1heSBjb250YWlu
ICdcJyBpZiBpdCBpcyBpbiBXaW5kb3dzCiAgICAgICAgICMgJ0RPTUFJTlx1c2VybmFtZScgZm9y
bWF0LiBGaXggdGhpcyBmb3IgdGhlIGtleWZpbGUgcGF0aC4KICAgICAgICAga2V5ZmlsZSA9IG9z
LnBhdGguam9pbigKQEAgLTE5NSwyMyArMjA3LDI0IEBAIGRlZiBta19rZXkob3B0cywgdXNlcik6
CiAgICAgICAgICkKIAogICAgIGlmIG9zLnBhdGguZXhpc3RzKGtleWZpbGUpOgotICAgICAgICBs
b2cuZGVidWcoJ1JlbW92aW5nIHN0YWxlIGtleWZpbGU6ICVzJywga2V5ZmlsZSkKLSAgICAgICAg
aWYgc2FsdC51dGlscy5wbGF0Zm9ybS5pc193aW5kb3dzKCkgYW5kIG5vdCBvcy5hY2Nlc3Moa2V5
ZmlsZSwgb3MuV19PSyk6CisgICAgICAgIGxvZy5kZWJ1ZygnUmVtb3Zpbmcgc3RhbGUga2V5Zmls
ZTogezB9Jy5mb3JtYXQoa2V5ZmlsZSkpCisgICAgICAgIGlmIHNhbHQudXRpbHMuaXNfd2luZG93
cygpIGFuZCBub3Qgb3MuYWNjZXNzKGtleWZpbGUsIG9zLldfT0spOgogICAgICAgICAgICAgIyBD
YW5ub3QgZGVsZXRlIHJlYWQtb25seSBmaWxlcyBvbiBXaW5kb3dzLgogICAgICAgICAgICAgb3Mu
Y2htb2Qoa2V5ZmlsZSwgc3RhdC5TX0lSVVNSIHwgc3RhdC5TX0lXVVNSKQogICAgICAgICBvcy51
bmxpbmsoa2V5ZmlsZSkKIAogICAgIGtleSA9IHNhbHQuY3J5cHQuQ3J5cHRpY2xlLmdlbmVyYXRl
X2tleV9zdHJpbmcoKQotICAgIHdpdGggc2FsdC51dGlscy5maWxlcy5zZXRfdW1hc2soMG8yNzcp
OgotICAgICAgICB3aXRoIHNhbHQudXRpbHMuZmlsZXMuZm9wZW4oa2V5ZmlsZSwgJ3crJykgYXMg
ZnBfOgotICAgICAgICAgICAgZnBfLndyaXRlKHNhbHQudXRpbHMuc3RyaW5ndXRpbHMudG9fc3Ry
KGtleSkpCisgICAgY3VtYXNrID0gb3MudW1hc2soMTkxKQorICAgIHdpdGggc2FsdC51dGlscy5m
b3BlbihrZXlmaWxlLCAndysnKSBhcyBmcF86CisgICAgICAgIGZwXy53cml0ZShrZXkpCisgICAg
b3MudW1hc2soY3VtYXNrKQogICAgICMgNjAwIG9jdGFsOiBSZWFkIGFuZCB3cml0ZSBhY2Nlc3Mg
dG8gdGhlIG93bmVyIG9ubHkuCiAgICAgIyBXcml0ZSBhY2Nlc3MgaXMgbmVjZXNzYXJ5IHNpbmNl
IG9uIHN1YnNlcXVlbnQgcnVucywgaWYgdGhlIGZpbGUKICAgICAjIGV4aXN0cywgaXQgbmVlZHMg
dG8gYmUgd3JpdHRlbiB0byBhZ2Fpbi4gV2luZG93cyBlbmZvcmNlcyB0aGlzLgogICAgIG9zLmNo
bW9kKGtleWZpbGUsIDBvNjAwKQotICAgIGlmIEhBU19QV0QgYW5kIHVpZCBpcyBub3QgTm9uZToK
KyAgICBpZiBIQVNfUFdEOgogICAgICAgICB0cnk6Ci0gICAgICAgICAgICBvcy5jaG93bihrZXlm
aWxlLCB1aWQsIC0xKQorICAgICAgICAgICAgb3MuY2hvd24oa2V5ZmlsZSwgcHdkLmdldHB3bmFt
KHVzZXIpLnB3X3VpZCwgLTEpCiAgICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICAg
IyBUaGUgbWFzdGVyIGlzIG5vdCBiZWluZyBydW4gYXMgcm9vdCBhbmQgY2FuIHRoZXJlZm9yZSBu
b3QKICAgICAgICAgICAgICMgY2hvd24gdGhlIGtleSBmaWxlCkBAIC0yMjYsMzQgKzIzOSw0MiBA
QCBkZWYgYWNjZXNzX2tleXMob3B0cyk6CiAgICAgJycnCiAgICAgIyBUT0RPOiBOZWVkIGEgd2F5
IHRvIGdldCBhbGwgYXZhaWxhYmxlIHVzZXJzIGZvciBzeXN0ZW1zIG5vdCBzdXBwb3J0ZWQgYnkg
cHdkIG1vZHVsZS4KICAgICAjICAgICAgIEZvciBub3cgdXNlcnMgcGF0dGVybiBtYXRjaGluZyB3
aWxsIG5vdCB3b3JrIGZvciBwdWJsaXNoZXJfYWNsLgorICAgIHVzZXJzID0gW10KICAgICBrZXlz
ID0ge30KLSAgICBwdWJsaXNoZXJfYWNsID0gb3B0c1sncHVibGlzaGVyX2FjbCddCisgICAgaWYg
b3B0c1snY2xpZW50X2FjbCddIG9yIG9wdHNbJ2NsaWVudF9hY2xfYmxhY2tsaXN0J106CisgICAg
ICAgIHNhbHQudXRpbHMud2Fybl91bnRpbCgKKyAgICAgICAgICAgICAgICAnTml0cm9nZW4nLAor
ICAgICAgICAgICAgICAgICdBQ0wgcnVsZXMgc2hvdWxkIGJlIGNvbmZpZ3VyZWQgd2l0aCBcJ3B1
Ymxpc2hlcl9hY2xcJyBhbmQgJworICAgICAgICAgICAgICAgICdcJ3B1Ymxpc2hlcl9hY2xfYmxh
Y2tsaXN0XCcgbm90IFwnY2xpZW50X2FjbFwnIGFuZCBcJ2NsaWVudF9hY2xfYmxhY2tsaXN0XCcu
ICcKKyAgICAgICAgICAgICAgICAnVGhpcyBmdW5jdGlvbmFsaXR5IHdpbGwgYmUgcmVtb3ZlZCBp
biBTYWx0IE5pdHJvZ2VuLicKKyAgICAgICAgICAgICAgICApCisgICAgcHVibGlzaGVyX2FjbCA9
IG9wdHNbJ3B1Ymxpc2hlcl9hY2wnXSBvciBvcHRzWydjbGllbnRfYWNsJ10KICAgICBhY2xfdXNl
cnMgPSBzZXQocHVibGlzaGVyX2FjbC5rZXlzKCkpCiAgICAgaWYgb3B0cy5nZXQoJ3VzZXInKToK
ICAgICAgICAgYWNsX3VzZXJzLmFkZChvcHRzWyd1c2VyJ10pCi0gICAgYWNsX3VzZXJzLmFkZChz
YWx0LnV0aWxzLnVzZXIuZ2V0X3VzZXIoKSkKKyAgICBhY2xfdXNlcnMuYWRkKHNhbHQudXRpbHMu
Z2V0X3VzZXIoKSkKKyAgICBpZiBvcHRzWydjbGllbnRfYWNsX3ZlcmlmeSddIGFuZCBIQVNfUFdE
OgorICAgICAgICBsb2cucHJvZmlsZSgnQmVnaW5uaW5nIHB3ZC5nZXRwd2FsbCgpIGNhbGwgaW4g
bWFzdGVyYXJwaSBhY2Nlc3Nfa2V5cyBmdW5jdGlvbicpCisgICAgICAgIGZvciB1c2VyIGluIHB3
ZC5nZXRwd2FsbCgpOgorICAgICAgICAgICAgdXNlcnMuYXBwZW5kKHVzZXIucHdfbmFtZSkKKyAg
ICAgICAgbG9nLnByb2ZpbGUoJ0VuZCBwd2QuZ2V0cHdhbGwoKSBjYWxsIGluIG1hc3RlcmFycGkg
YWNjZXNzX2tleXMgZnVuY3Rpb24nKQogICAgIGZvciB1c2VyIGluIGFjbF91c2VyczoKICAgICAg
ICAgbG9nLmluZm8oJ1ByZXBhcmluZyB0aGUgJXMga2V5IGZvciBsb2NhbCBjb21tdW5pY2F0aW9u
JywgdXNlcikKLSAgICAgICAga2V5ID0gbWtfa2V5KG9wdHMsIHVzZXIpCi0gICAgICAgIGlmIGtl
eSBpcyBub3QgTm9uZToKLSAgICAgICAgICAgIGtleXNbdXNlcl0gPSBrZXkKKyAgICAgICAga2V5
c1t1c2VyXSA9IG1rX2tleShvcHRzLCB1c2VyKQogCiAgICAgIyBDaGVjayBvdGhlciB1c2VycyBt
YXRjaGluZyBBQ0wgcGF0dGVybnMKLSAgICBpZiBvcHRzWydjbGllbnRfYWNsX3ZlcmlmeSddIGFu
ZCBIQVNfUFdEOgotICAgICAgICBsb2cucHJvZmlsZSgnQmVnaW5uaW5nIHB3ZC5nZXRwd2FsbCgp
IGNhbGwgaW4gbWFzdGVyYXBpIGFjY2Vzc19rZXlzIGZ1bmN0aW9uJykKLSAgICAgICAgZm9yIHVz
ZXIgaW4gcHdkLmdldHB3YWxsKCk6Ci0gICAgICAgICAgICB1c2VyID0gdXNlci5wd19uYW1lCi0g
ICAgICAgICAgICBpZiB1c2VyIG5vdCBpbiBrZXlzIGFuZCBzYWx0LnV0aWxzLnN0cmluZ3V0aWxz
LmNoZWNrX3doaXRlbGlzdF9ibGFja2xpc3QodXNlciwgd2hpdGVsaXN0PWFjbF91c2Vycyk6Cisg
ICAgaWYgSEFTX1BXRDoKKyAgICAgICAgZm9yIHVzZXIgaW4gdXNlcnM6CisgICAgICAgICAgICBp
ZiB1c2VyIG5vdCBpbiBrZXlzIGFuZCBzYWx0LnV0aWxzLmNoZWNrX3doaXRlbGlzdF9ibGFja2xp
c3QodXNlciwgd2hpdGVsaXN0PWFjbF91c2Vycyk6CiAgICAgICAgICAgICAgICAga2V5c1t1c2Vy
XSA9IG1rX2tleShvcHRzLCB1c2VyKQotICAgICAgICBsb2cucHJvZmlsZSgnRW5kIHB3ZC5nZXRw
d2FsbCgpIGNhbGwgaW4gbWFzdGVyYXBpIGFjY2Vzc19rZXlzIGZ1bmN0aW9uJykKIAogICAgIHJl
dHVybiBrZXlzCiAKIAogZGVmIGZpbGVzZXJ2ZXJfdXBkYXRlKGZpbGVzZXJ2ZXIpOgogICAgICcn
JwotICAgIFVwZGF0ZSB0aGUgZmlsZXNlcnZlciBiYWNrZW5kcywgcmVxdWlyZXMgdGhhdCBhIHNh
bHQuZmlsZXNlcnZlci5GaWxlc2VydmVyCi0gICAgb2JqZWN0IGJlIHBhc3NlZCBpbgorICAgIFVw
ZGF0ZSB0aGUgZmlsZXNlcnZlciBiYWNrZW5kcywgcmVxdWlyZXMgdGhhdCBhIGJ1aWx0IGZpbGVz
ZXJ2ZXIgb2JqZWN0CisgICAgYmUgcGFzc2VkIGluCiAgICAgJycnCiAgICAgdHJ5OgogICAgICAg
ICBpZiBub3QgZmlsZXNlcnZlci5zZXJ2ZXJzOgpAQCAtMjYxLDExICsyODIsMTEgQEAgZGVmIGZp
bGVzZXJ2ZXJfdXBkYXRlKGZpbGVzZXJ2ZXIpOgogICAgICAgICAgICAgICAgICdObyBmaWxlc2Vy
dmVycyBsb2FkZWQsIHRoZSBtYXN0ZXIgd2lsbCBub3QgYmUgYWJsZSB0byAnCiAgICAgICAgICAg
ICAgICAgJ3NlcnZlIGZpbGVzIHRvIG1pbmlvbnMnCiAgICAgICAgICAgICApCi0gICAgICAgICAg
ICByYWlzZSBzYWx0LmV4Y2VwdGlvbnMuU2FsdE1hc3RlckVycm9yKCdObyBmaWxlc2VydmVyIGJh
Y2tlbmRzIGF2YWlsYWJsZScpCisgICAgICAgICAgICByYWlzZSBTYWx0TWFzdGVyRXJyb3IoJ05v
IGZpbGVzZXJ2ZXIgYmFja2VuZHMgYXZhaWxhYmxlJykKICAgICAgICAgZmlsZXNlcnZlci51cGRh
dGUoKQogICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICBsb2cuZXJyb3IoCi0g
ICAgICAgICAgICAnRXhjZXB0aW9uICVzIG9jY3VycmVkIGluIGZpbGUgc2VydmVyIHVwZGF0ZScs
IGV4YywKKyAgICAgICAgICAgICdFeGNlcHRpb24gezB9IG9jY3VycmVkIGluIGZpbGUgc2VydmVy
IHVwZGF0ZScuZm9ybWF0KGV4YyksCiAgICAgICAgICAgICBleGNfaW5mb19vbl9sb2dsZXZlbD1s
b2dnaW5nLkRFQlVHCiAgICAgICAgICkKIApAQCAtMjgxLDI3ICszMDIsNTAgQEAgY2xhc3MgQXV0
b0tleShvYmplY3QpOgogICAgICAgICAnJycKICAgICAgICAgQ2hlY2sgaWYgdGhlIHNwZWNpZmll
ZCBmaWxlbmFtZSBoYXMgY29ycmVjdCBwZXJtaXNzaW9ucwogICAgICAgICAnJycKLSAgICAgICAg
aWYgc2FsdC51dGlscy5wbGF0Zm9ybS5pc193aW5kb3dzKCk6CisgICAgICAgIGlmIHNhbHQudXRp
bHMuaXNfd2luZG93cygpOgogICAgICAgICAgICAgcmV0dXJuIFRydWUKIAogICAgICAgICAjIEFm
dGVyIHdlJ3ZlIGFzY2VydGFpbmVkIHdlJ3JlIG5vdCBvbiB3aW5kb3dzCi0gICAgICAgIGdyb3Vw
cyA9IHNhbHQudXRpbHMudXNlci5nZXRfZ2lkX2xpc3Qoc2VsZi5vcHRzWyd1c2VyJ10sIGluY2x1
ZGVfZGVmYXVsdD1GYWxzZSkKLSAgICAgICAgZm1vZGUgPSBvcy5zdGF0KGZpbGVuYW1lKQotCi0g
ICAgICAgIGlmIHN0YXQuU19JV09USCAmIGZtb2RlLnN0X21vZGU6Ci0gICAgICAgICAgICAjIGRv
bid0IGFsbG93IG90aGVycyB0byB3cml0ZSB0byB0aGUgZmlsZQorICAgICAgICB0cnk6CisgICAg
ICAgICAgICB1c2VyID0gc2VsZi5vcHRzWyd1c2VyJ10KKyAgICAgICAgICAgIHB3bmFtID0gcHdk
LmdldHB3bmFtKHVzZXIpCisgICAgICAgICAgICB1aWQgPSBwd25hbVsyXQorICAgICAgICAgICAg
Z2lkID0gcHduYW1bM10KKyAgICAgICAgICAgIGdyb3VwcyA9IHNhbHQudXRpbHMuZ2V0X2dpZF9s
aXN0KHVzZXIsIGluY2x1ZGVfZGVmYXVsdD1GYWxzZSkKKyAgICAgICAgZXhjZXB0IEtleUVycm9y
OgorICAgICAgICAgICAgbG9nLmVycm9yKAorICAgICAgICAgICAgICAgICdGYWlsZWQgdG8gZGV0
ZXJtaW5lIGdyb3VwcyBmb3IgdXNlciB7MH0uIFRoZSB1c2VyIGlzIG5vdCAnCisgICAgICAgICAg
ICAgICAgJ2F2YWlsYWJsZS5cbicuZm9ybWF0KAorICAgICAgICAgICAgICAgICAgICB1c2VyCisg
ICAgICAgICAgICAgICAgKQorICAgICAgICAgICAgKQogICAgICAgICAgICAgcmV0dXJuIEZhbHNl
CiAKLSAgICAgICAgaWYgc3RhdC5TX0lXR1JQICYgZm1vZGUuc3RfbW9kZToKLSAgICAgICAgICAg
ICMgaWYgdGhlIGdyb3VwIGhhcyB3cml0ZSBhY2Nlc3Mgb25seSBhbGxvdyB3aXRoIHBlcm1pc3Np
dmVfcGtpX2FjY2VzcwotICAgICAgICAgICAgaWYgbm90IHNlbGYub3B0cy5nZXQoJ3Blcm1pc3Np
dmVfcGtpX2FjY2VzcycsIEZhbHNlKToKKyAgICAgICAgZm1vZGUgPSBvcy5zdGF0KGZpbGVuYW1l
KQorCisgICAgICAgIGlmIG9zLmdldHVpZCgpID09IDA6CisgICAgICAgICAgICBpZiBmbW9kZS5z
dF91aWQgPT0gdWlkIG9yIGZtb2RlLnN0X2dpZCAhPSBnaWQ6CisgICAgICAgICAgICAgICAgcmV0
dXJuIFRydWUKKyAgICAgICAgICAgIGVsaWYgc2VsZi5vcHRzLmdldCgncGVybWlzc2l2ZV9wa2lf
YWNjZXNzJywgRmFsc2UpIFwKKyAgICAgICAgICAgICAgICAgICAgYW5kIGZtb2RlLnN0X2dpZCBp
biBncm91cHM6CisgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKKyAgICAgICAgZWxzZToKKyAg
ICAgICAgICAgIGlmIHN0YXQuU19JV09USCAmIGZtb2RlLnN0X21vZGU6CisgICAgICAgICAgICAg
ICAgIyBkb24ndCBhbGxvdyBvdGhlcnMgdG8gd3JpdGUgdG8gdGhlIGZpbGUKICAgICAgICAgICAg
ICAgICByZXR1cm4gRmFsc2UKLSAgICAgICAgICAgIGVsaWYgb3MuZ2V0dWlkKCkgPT0gMCBhbmQg
Zm1vZGUuc3RfZ2lkIG5vdCBpbiBncm91cHM6Ci0gICAgICAgICAgICAgICAgIyBpZiBzYWx0IGlz
IHJvb3QgaXQgaGFzIHRvIGJlIGluIHRoZSBncm91cCB0aGF0IGhhcyB3cml0ZSBhY2Nlc3MKLSAg
ICAgICAgICAgICAgICAjIHRoaXMgZ2l2ZXMgdGhlIGdyb3VwICdwZXJtaXNzaW9uJyB0byBoYXZl
IHdyaXRlIGFjY2VzcworCisgICAgICAgICAgICAjIGNoZWNrIGdyb3VwIGZsYWdzCisgICAgICAg
ICAgICBpZiBzZWxmLm9wdHMuZ2V0KCdwZXJtaXNzaXZlX3BraV9hY2Nlc3MnLCBGYWxzZSkgYW5k
IHN0YXQuU19JV0dSUCAmIGZtb2RlLnN0X21vZGU6CisgICAgICAgICAgICAgICAgcmV0dXJuIFRy
dWUKKyAgICAgICAgICAgIGVsaWYgc3RhdC5TX0lXR1JQICYgZm1vZGUuc3RfbW9kZToKICAgICAg
ICAgICAgICAgICByZXR1cm4gRmFsc2UKIAotICAgICAgICByZXR1cm4gVHJ1ZQorICAgICAgICAg
ICAgIyBjaGVjayBpZiB3cml0YWJsZSBieSBncm91cCBvciBvdGhlcgorICAgICAgICAgICAgaWYg
bm90IChzdGF0LlNfSVdHUlAgJiBmbW9kZS5zdF9tb2RlIG9yCisgICAgICAgICAgICAgICAgICAg
IHN0YXQuU19JV09USCAmIGZtb2RlLnN0X21vZGUpOgorICAgICAgICAgICAgICAgIHJldHVybiBU
cnVlCisKKyAgICAgICAgcmV0dXJuIEZhbHNlCiAKICAgICBkZWYgY2hlY2tfc2lnbmluZ19maWxl
KHNlbGYsIGtleWlkLCBzaWduaW5nX2ZpbGUpOgogICAgICAgICAnJycKQEAgLTMxMSwxNiArMzU1
LDE3IEBAIGNsYXNzIEF1dG9LZXkob2JqZWN0KToKICAgICAgICAgICAgIHJldHVybiBGYWxzZQog
CiAgICAgICAgIGlmIG5vdCBzZWxmLmNoZWNrX3Blcm1pc3Npb25zKHNpZ25pbmdfZmlsZSk6Ci0g
ICAgICAgICAgICBsb2cud2FybmluZygnV3JvbmcgcGVybWlzc2lvbnMgZm9yICVzLCBpZ25vcmlu
ZyBjb250ZW50Jywgc2lnbmluZ19maWxlKQorICAgICAgICAgICAgbWVzc2FnZSA9ICdXcm9uZyBw
ZXJtaXNzaW9ucyBmb3IgezB9LCBpZ25vcmluZyBjb250ZW50JworICAgICAgICAgICAgbG9nLndh
cm5pbmcobWVzc2FnZS5mb3JtYXQoc2lnbmluZ19maWxlKSkKICAgICAgICAgICAgIHJldHVybiBG
YWxzZQogCi0gICAgICAgIHdpdGggc2FsdC51dGlscy5maWxlcy5mb3BlbihzaWduaW5nX2ZpbGUs
ICdyJykgYXMgZnBfOgorICAgICAgICB3aXRoIHNhbHQudXRpbHMuZm9wZW4oc2lnbmluZ19maWxl
LCAncicpIGFzIGZwXzoKICAgICAgICAgICAgIGZvciBsaW5lIGluIGZwXzoKICAgICAgICAgICAg
ICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgaWYgbGluZS5zdGFydHN3
aXRoKCcjJyk6CiAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAg
ZWxzZToKLSAgICAgICAgICAgICAgICAgICAgaWYgc2FsdC51dGlscy5zdHJpbmd1dGlscy5leHBy
X21hdGNoKGtleWlkLCBsaW5lKToKKyAgICAgICAgICAgICAgICAgICAgaWYgc2FsdC51dGlscy5l
eHByX21hdGNoKGtleWlkLCBsaW5lKToKICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBU
cnVlCiAgICAgICAgIHJldHVybiBGYWxzZQogCkBAIC0zMzQsMTIgKzM3OSwxMiBAQCBjbGFzcyBB
dXRvS2V5KG9iamVjdCk6CiAgICAgICAgIGV4cGlyZV9taW51dGVzID0gc2VsZi5vcHRzLmdldCgn
YXV0b3NpZ25fdGltZW91dCcsIDEyMCkKICAgICAgICAgaWYgZXhwaXJlX21pbnV0ZXMgPiAwOgog
ICAgICAgICAgICAgbWluX3RpbWUgPSB0aW1lLnRpbWUoKSAtICg2MCAqIGludChleHBpcmVfbWlu
dXRlcykpCi0gICAgICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZW5hbWVzIGluIHNhbHQudXRp
bHMucGF0aC5vc193YWxrKGF1dG9zaWduX2Rpcik6CisgICAgICAgICAgICBmb3Igcm9vdCwgZGly
cywgZmlsZW5hbWVzIGluIG9zLndhbGsoYXV0b3NpZ25fZGlyKToKICAgICAgICAgICAgICAgICBm
b3IgZiBpbiBmaWxlbmFtZXM6CiAgICAgICAgICAgICAgICAgICAgIHN0dWJfZmlsZSA9IG9zLnBh
dGguam9pbihhdXRvc2lnbl9kaXIsIGYpCiAgICAgICAgICAgICAgICAgICAgIG10aW1lID0gb3Mu
cGF0aC5nZXRtdGltZShzdHViX2ZpbGUpCiAgICAgICAgICAgICAgICAgICAgIGlmIG10aW1lIDwg
bWluX3RpbWU6Ci0gICAgICAgICAgICAgICAgICAgICAgICBsb2cud2FybmluZygnQXV0b3NpZ24g
a2V5aWQgZXhwaXJlZCAlcycsIHN0dWJfZmlsZSkKKyAgICAgICAgICAgICAgICAgICAgICAgIGxv
Zy53YXJuaW5nKCdBdXRvc2lnbiBrZXlpZCBleHBpcmVkIHswfScuZm9ybWF0KHN0dWJfZmlsZSkp
CiAgICAgICAgICAgICAgICAgICAgICAgICBvcy5yZW1vdmUoc3R1Yl9maWxlKQogCiAgICAgICAg
IHN0dWJfZmlsZSA9IG9zLnBhdGguam9pbihhdXRvc2lnbl9kaXIsIGtleWlkKQpAQCAtMzQ4LDM1
ICszOTMsNiBAQCBjbGFzcyBBdXRvS2V5KG9iamVjdCk6CiAgICAgICAgIG9zLnJlbW92ZShzdHVi
X2ZpbGUpCiAgICAgICAgIHJldHVybiBUcnVlCiAKLSAgICBkZWYgY2hlY2tfYXV0b3NpZ25fZ3Jh
aW5zKHNlbGYsIGF1dG9zaWduX2dyYWlucyk6Ci0gICAgICAgICcnJwotICAgICAgICBDaGVjayBm
b3IgbWF0Y2hpbmcgZ3JhaW5zIGluIHRoZSBhdXRvc2lnbl9ncmFpbnNfZGlyLgotICAgICAgICAn
JycKLSAgICAgICAgaWYgbm90IGF1dG9zaWduX2dyYWlucyBvciAnYXV0b3NpZ25fZ3JhaW5zX2Rp
cicgbm90IGluIHNlbGYub3B0czoKLSAgICAgICAgICAgIHJldHVybiBGYWxzZQotCi0gICAgICAg
IGF1dG9zaWduX2dyYWluc19kaXIgPSBzZWxmLm9wdHNbJ2F1dG9zaWduX2dyYWluc19kaXInXQot
ICAgICAgICBmb3Igcm9vdCwgZGlycywgZmlsZW5hbWVzIGluIG9zLndhbGsoYXV0b3NpZ25fZ3Jh
aW5zX2Rpcik6Ci0gICAgICAgICAgICBmb3IgZ3JhaW4gaW4gZmlsZW5hbWVzOgotICAgICAgICAg
ICAgICAgIGlmIGdyYWluIGluIGF1dG9zaWduX2dyYWluczoKLSAgICAgICAgICAgICAgICAgICAg
Z3JhaW5fZmlsZSA9IG9zLnBhdGguam9pbihhdXRvc2lnbl9ncmFpbnNfZGlyLCBncmFpbikKLQot
ICAgICAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5jaGVja19wZXJtaXNzaW9ucyhncmFpbl9m
aWxlKToKLSAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICdXcm9uZyBwZXJtaXNzaW9ucyBmb3IgJXMsIGlnbm9yaW5nIGNvbnRl
bnQnLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyYWluX2ZpbGUKLSAgICAgICAgICAg
ICAgICAgICAgICAgICkKLSAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCi0KLSAgICAg
ICAgICAgICAgICAgICAgd2l0aCBzYWx0LnV0aWxzLmZpbGVzLmZvcGVuKGdyYWluX2ZpbGUsICdy
JykgYXMgZjoKLSAgICAgICAgICAgICAgICAgICAgICAgIGZvciBsaW5lIGluIGY6Ci0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbGluZSA9IHNhbHQudXRpbHMuc3RyaW5ndXRpbHMudG9fdW5p
Y29kZShsaW5lKS5zdHJpcCgpCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGluZS5z
dGFydHN3aXRoKCcjJyk6Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVl
Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXV0b3NpZ25fZ3JhaW5zW2dyYWluXSA9
PSBsaW5lOgotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQotICAg
ICAgICByZXR1cm4gRmFsc2UKLQogICAgIGRlZiBjaGVja19hdXRvcmVqZWN0KHNlbGYsIGtleWlk
KToKICAgICAgICAgJycnCiAgICAgICAgIENoZWNrcyBpZiB0aGUgc3BlY2lmaWVkIGtleWlkIHNo
b3VsZCBhdXRvbWF0aWNhbGx5IGJlIHJlamVjdGVkLgpAQCAtMzg2LDcgKzQwMiw3IEBAIGNsYXNz
IEF1dG9LZXkob2JqZWN0KToKICAgICAgICAgICAgIHNlbGYub3B0cy5nZXQoJ2F1dG9yZWplY3Rf
ZmlsZScsIE5vbmUpCiAgICAgICAgICkKIAotICAgIGRlZiBjaGVja19hdXRvc2lnbihzZWxmLCBr
ZXlpZCwgYXV0b3NpZ25fZ3JhaW5zPU5vbmUpOgorICAgIGRlZiBjaGVja19hdXRvc2lnbihzZWxm
LCBrZXlpZCk6CiAgICAgICAgICcnJwogICAgICAgICBDaGVja3MgaWYgdGhlIHNwZWNpZmllZCBr
ZXlpZCBzaG91bGQgYXV0b21hdGljYWxseSBiZSBzaWduZWQuCiAgICAgICAgICcnJwpAQCAtMzk2
LDggKzQxMiw2IEBAIGNsYXNzIEF1dG9LZXkob2JqZWN0KToKICAgICAgICAgICAgIHJldHVybiBU
cnVlCiAgICAgICAgIGlmIHNlbGYuY2hlY2tfYXV0b3NpZ25fZGlyKGtleWlkKToKICAgICAgICAg
ICAgIHJldHVybiBUcnVlCi0gICAgICAgIGlmIHNlbGYuY2hlY2tfYXV0b3NpZ25fZ3JhaW5zKGF1
dG9zaWduX2dyYWlucyk6Ci0gICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgICByZXR1cm4g
RmFsc2UKIAogCkBAIC00NzAsMTMgKzQ4NCwxNiBAQCBjbGFzcyBSZW1vdGVGdW5jcyhvYmplY3Qp
OgogICAgICAgICAgICAgZm9yIGFyZyBpbiBsb2FkWydhcmcnXToKICAgICAgICAgICAgICAgICBh
cmdfLmFwcGVuZChhcmcuc3BsaXQoKSkKICAgICAgICAgICAgIGxvYWRbJ2FyZyddID0gYXJnXwot
ICAgICAgICByZXR1cm4gc2VsZi5ja21pbmlvbnMuYXV0aF9jaGVjaygKKyAgICAgICAgZ29vZCA9
IHNlbGYuY2ttaW5pb25zLmF1dGhfY2hlY2soCiAgICAgICAgICAgICAgICAgcGVybXMsCiAgICAg
ICAgICAgICAgICAgbG9hZFsnZnVuJ10sCiAgICAgICAgICAgICAgICAgbG9hZFsnYXJnJ10sCiAg
ICAgICAgICAgICAgICAgbG9hZFsndGd0J10sCiAgICAgICAgICAgICAgICAgbG9hZC5nZXQoJ3Rn
dF90eXBlJywgJ2dsb2InKSwKICAgICAgICAgICAgICAgICBwdWJsaXNoX3ZhbGlkYXRlPVRydWUp
CisgICAgICAgIGlmIG5vdCBnb29kOgorICAgICAgICAgICAgcmV0dXJuIEZhbHNlCisgICAgICAg
IHJldHVybiBUcnVlCiAKICAgICBkZWYgX21hc3Rlcl9vcHRzKHNlbGYsIGxvYWQpOgogICAgICAg
ICAnJycKQEAgLTUwMiwxNSArNTE5LDE0IEBAIGNsYXNzIFJlbW90ZUZ1bmNzKG9iamVjdCk6CiAg
ICAgICAgIG1vcHRzWydzdGF0ZV9hdXRvX29yZGVyJ10gPSBzZWxmLm9wdHNbJ3N0YXRlX2F1dG9f
b3JkZXInXQogICAgICAgICBtb3B0c1snc3RhdGVfZXZlbnRzJ10gPSBzZWxmLm9wdHNbJ3N0YXRl
X2V2ZW50cyddCiAgICAgICAgIG1vcHRzWydzdGF0ZV9hZ2dyZWdhdGUnXSA9IHNlbGYub3B0c1sn
c3RhdGVfYWdncmVnYXRlJ10KLSAgICAgICAgbW9wdHNbJ2ppbmphX2VudiddID0gc2VsZi5vcHRz
WydqaW5qYV9lbnYnXQotICAgICAgICBtb3B0c1snamluamFfc2xzX2VudiddID0gc2VsZi5vcHRz
WydqaW5qYV9zbHNfZW52J10KICAgICAgICAgbW9wdHNbJ2ppbmphX2xzdHJpcF9ibG9ja3MnXSA9
IHNlbGYub3B0c1snamluamFfbHN0cmlwX2Jsb2NrcyddCiAgICAgICAgIG1vcHRzWydqaW5qYV90
cmltX2Jsb2NrcyddID0gc2VsZi5vcHRzWydqaW5qYV90cmltX2Jsb2NrcyddCiAgICAgICAgIHJl
dHVybiBtb3B0cwogCi0gICAgZGVmIF9tYXN0ZXJfdG9wcyhzZWxmLCBsb2FkLCBza2lwX3Zlcmlm
eT1GYWxzZSk6CisgICAgZGVmIF9leHRfbm9kZXMoc2VsZiwgbG9hZCwgc2tpcF92ZXJpZnk9RmFs
c2UpOgogICAgICAgICAnJycKLSAgICAgICAgUmV0dXJuIHRoZSByZXN1bHRzIGZyb20gbWFzdGVy
X3RvcHMgaWYgY29uZmlndXJlZAorICAgICAgICBSZXR1cm4gdGhlIHJlc3VsdHMgZnJvbSBhbiBl
eHRlcm5hbCBub2RlIGNsYXNzaWZpZXIgaWYgb25lIGlzCisgICAgICAgIHNwZWNpZmllZAogICAg
ICAgICAnJycKICAgICAgICAgaWYgbm90IHNraXBfdmVyaWZ5OgogICAgICAgICAgICAgaWYgJ2lk
JyBub3QgaW4gbG9hZDoKQEAgLTUzNiw4ICs1NTIsMTAgQEAgY2xhc3MgUmVtb3RlRnVuY3Mob2Jq
ZWN0KToKICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOgogICAgICAgICAgICAg
ICAgICMgSWYgYW55dGhpbmcgaGFwcGVucyBpbiB0aGUgdG9wIGdlbmVyYXRpb24sIGxvZyBpdCBh
bmQgbW92ZSBvbgogICAgICAgICAgICAgICAgIGxvZy5lcnJvcigKLSAgICAgICAgICAgICAgICAg
ICAgJ1RvcCBmdW5jdGlvbiAlcyBmYWlsZWQgd2l0aCBlcnJvciAlcyBmb3IgbWluaW9uICVzJywK
LSAgICAgICAgICAgICAgICAgICAgZnVuLCBleGMsIGxvYWRbJ2lkJ10KKyAgICAgICAgICAgICAg
ICAgICAgJ1RvcCBmdW5jdGlvbiB7MH0gZmFpbGVkIHdpdGggZXJyb3IgezF9IGZvciBtaW5pb24g
JworICAgICAgICAgICAgICAgICAgICAnezJ9Jy5mb3JtYXQoCisgICAgICAgICAgICAgICAgICAg
ICAgICBmdW4sIGV4YywgbG9hZFsnaWQnXQorICAgICAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgICAgICAgKQogICAgICAgICByZXR1cm4gcmV0CiAKQEAgLTU0OSw5ICs1NjcsMTEgQEAgY2xh
c3MgUmVtb3RlRnVuY3Mob2JqZWN0KToKICAgICAgICAgICAgIGlmIGFueShrZXkgbm90IGluIGxv
YWQgZm9yIGtleSBpbiAoJ2lkJywgJ3RndCcsICdmdW4nKSk6CiAgICAgICAgICAgICAgICAgcmV0
dXJuIHt9CiAKKyAgICAgICAgX3JldF9kaWN0ID0gRmFsc2UKICAgICAgICAgaWYgaXNpbnN0YW5j
ZShsb2FkWydmdW4nXSwgc2l4LnN0cmluZ190eXBlcyk6CiAgICAgICAgICAgICBmdW5jdGlvbnMg
PSBsaXN0KHNldChsb2FkWydmdW4nXS5zcGxpdCgnLCcpKSkKLSAgICAgICAgICAgIF9yZXRfZGlj
dCA9IGxlbihmdW5jdGlvbnMpID4gMQorICAgICAgICAgICAgaWYgbGVuKGZ1bmN0aW9ucykgPiAx
OgorICAgICAgICAgICAgICAgIF9yZXRfZGljdCA9IFRydWUKICAgICAgICAgZWxpZiBpc2luc3Rh
bmNlKGxvYWRbJ2Z1biddLCBsaXN0KToKICAgICAgICAgICAgIGZ1bmN0aW9ucyA9IGxvYWRbJ2Z1
biddCiAgICAgICAgICAgICBfcmV0X2RpY3QgPSBUcnVlCkBAIC01NzAsNTIgKzU5MCw0MSBAQCBj
bGFzcyBSZW1vdGVGdW5jcyhvYmplY3QpOgogICAgICAgICAgICAgICAgICAgICBpZiBpc2luc3Rh
bmNlKHNlbGYub3B0c1snbWluZV9nZXQnXVttYXRjaF0sIGxpc3QpOgogICAgICAgICAgICAgICAg
ICAgICAgICAgcGVybXMudXBkYXRlKHNlbGYub3B0c1snbWluZV9nZXQnXVttYXRjaF0pCiAKKyAg
ICAgICAgICAgIF9mdW4gPSBbXQogICAgICAgICAgICAgZm9yIGZ1biBpbiBmdW5jdGlvbnM6CiAg
ICAgICAgICAgICAgICAgaWYgYW55KHJlLm1hdGNoKHBlcm0sIGZ1bikgZm9yIHBlcm0gaW4gcGVy
bXMpOgotICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnNfYWxsb3dlZC5hcHBlbmQoZnVuKQot
Ci0gICAgICAgICAgICBpZiBub3QgbGVuKGZ1bmN0aW9uc19hbGxvd2VkKToKKyAgICAgICAgICAg
ICAgICAgICAgX2Z1bi5hcHBlbmQoZnVuKQorICAgICAgICAgICAgaWYgbm90IGxlbihfZnVuKToK
ICAgICAgICAgICAgICAgICByZXR1cm4ge30KLSAgICAgICAgZWxzZToKLSAgICAgICAgICAgIGZ1
bmN0aW9uc19hbGxvd2VkID0gZnVuY3Rpb25zCisgICAgICAgICAgICBlbHNlOgorICAgICAgICAg
ICAgICAgIGZ1bmN0aW9uc19hbGxvd2VkID0gX2Z1bgogCiAgICAgICAgIHJldCA9IHt9CiAgICAg
ICAgIGlmIG5vdCBzYWx0LnV0aWxzLnZlcmlmeS52YWxpZF9pZChzZWxmLm9wdHMsIGxvYWRbJ2lk
J10pOgogICAgICAgICAgICAgcmV0dXJuIHJldAotICAgICAgICBleHByX2Zvcm0gPSBsb2FkLmdl
dCgnZXhwcl9mb3JtJykKLSAgICAgICAgaWYgZXhwcl9mb3JtIGlzIG5vdCBOb25lIGFuZCAndGd0
X3R5cGUnIG5vdCBpbiBsb2FkOgotICAgICAgICAgICAgc2FsdC51dGlscy52ZXJzaW9ucy53YXJu
X3VudGlsKAotICAgICAgICAgICAgICAgICdOZW9uJywKLSAgICAgICAgICAgICAgICAnX21pbmVf
Z2V0OiBtaW5pb24gezB9IHVzZXMgcHJlLU5pdHJvZ2VuIEFQSSBrZXkgJwotICAgICAgICAgICAg
ICAgICciZXhwcl9mb3JtIi4gQWNjZXB0aW5nIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAn
Ci0gICAgICAgICAgICAgICAgJ2J1dCB0aGlzIGlzIG5vdCBndWFyYW50ZWVkICcKLSAgICAgICAg
ICAgICAgICAnYWZ0ZXIgdGhlIE5lb24gcmVsZWFzZScuZm9ybWF0KGxvYWRbJ2lkJ10pCi0gICAg
ICAgICAgICApCi0gICAgICAgICAgICBtYXRjaF90eXBlID0gZXhwcl9mb3JtCi0gICAgICAgIGVs
c2U6Ci0gICAgICAgICAgICBtYXRjaF90eXBlID0gbG9hZC5nZXQoJ3RndF90eXBlJywgJ2dsb2In
KQorICAgICAgICBtYXRjaF90eXBlID0gbG9hZC5nZXQoJ2V4cHJfZm9ybScsICdnbG9iJykKICAg
ICAgICAgaWYgbWF0Y2hfdHlwZS5sb3dlcigpID09ICdwaWxsYXInOgogICAgICAgICAgICAgbWF0
Y2hfdHlwZSA9ICdwaWxsYXJfZXhhY3QnCiAgICAgICAgIGlmIG1hdGNoX3R5cGUubG93ZXIoKSA9
PSAnY29tcG91bmQnOgogICAgICAgICAgICAgbWF0Y2hfdHlwZSA9ICdjb21wb3VuZF9waWxsYXJf
ZXhhY3QnCiAgICAgICAgIGNoZWNrZXIgPSBzYWx0LnV0aWxzLm1pbmlvbnMuQ2tNaW5pb25zKHNl
bGYub3B0cykKLSAgICAgICAgX3JlcyA9IGNoZWNrZXIuY2hlY2tfbWluaW9ucygKKyAgICAgICAg
bWluaW9ucyA9IGNoZWNrZXIuY2hlY2tfbWluaW9ucygKICAgICAgICAgICAgICAgICBsb2FkWyd0
Z3QnXSwKICAgICAgICAgICAgICAgICBtYXRjaF90eXBlLAogICAgICAgICAgICAgICAgIGdyZWVk
eT1GYWxzZQogICAgICAgICAgICAgICAgICkKLSAgICAgICAgbWluaW9ucyA9IF9yZXNbJ21pbmlv
bnMnXQogICAgICAgICBmb3IgbWluaW9uIGluIG1pbmlvbnM6CiAgICAgICAgICAgICBmZGF0YSA9
IHNlbGYuY2FjaGUuZmV0Y2goJ21pbmlvbnMvezB9Jy5mb3JtYXQobWluaW9uKSwgJ21pbmUnKQog
CiAgICAgICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShmZGF0YSwgZGljdCk6CiAgICAgICAgICAg
ICAgICAgY29udGludWUKIAotICAgICAgICAgICAgaWYgbm90IF9yZXRfZGljdCBhbmQgZnVuY3Rp
b25zX2FsbG93ZWQgYW5kIGZ1bmN0aW9uc19hbGxvd2VkWzBdIGluIGZkYXRhOgotICAgICAgICAg
ICAgICAgIHJldFttaW5pb25dID0gZmRhdGEuZ2V0KGZ1bmN0aW9uc19hbGxvd2VkWzBdKQorICAg
ICAgICAgICAgaWYgbm90IF9yZXRfZGljdCBhbmQgZnVuY3Rpb25zX2FsbG93ZWRbMF0gaW4gZmRh
dGE6CisgICAgICAgICAgICAgICAgcmV0W21pbmlvbl0gPSBmZGF0YS5nZXQoZnVuKQogICAgICAg
ICAgICAgZWxpZiBfcmV0X2RpY3Q6Ci0gICAgICAgICAgICAgICAgZm9yIGZ1biBpbiBsaXN0KHNl
dChmdW5jdGlvbnNfYWxsb3dlZCkgJiBzZXQoZmRhdGEua2V5cygpKSk6Ci0gICAgICAgICAgICAg
ICAgICAgIHJldC5zZXRkZWZhdWx0KGZ1bix7fSlbbWluaW9uXSA9IGZkYXRhLmdldChmdW4pCisg
ICAgICAgICAgICAgICAgZm9yIGZ1biBpbiBmdW5jdGlvbnNfYWxsb3dlZDoKKyAgICAgICAgICAg
ICAgICAgICAgaWYgZnVuIGluIGZkYXRhOgorICAgICAgICAgICAgICAgICAgICAgICAgcmV0LnNl
dGRlZmF1bHQoZnVuLCB7fSlbbWluaW9uXSA9IGZkYXRhLmdldChmdW4pCiAKICAgICAgICAgcmV0
dXJuIHJldAogCkBAIC02ODcsMTcgKzY5NiwxMSBAQCBjbGFzcyBSZW1vdGVGdW5jcyhvYmplY3Qp
OgogICAgICAgICAgICAgbG9nLmVycm9yKCdJbnZhbGlkIGZpbGUgcG9pbnRlcjogbG9hZFtsb2Nd
IDwgMCcpCiAgICAgICAgICAgICByZXR1cm4gRmFsc2UKIAotICAgICAgICBpZiBsb2FkLmdldCgn
c2l6ZScsIDApID4gZmlsZV9yZWN2X21heF9zaXplOgotICAgICAgICAgICAgbG9nLmVycm9yKAot
ICAgICAgICAgICAgICAgICdFeGNlZWRpbmcgZmlsZV9yZWN2X21heF9zaXplIGxpbWl0OiAlcycs
Ci0gICAgICAgICAgICAgICAgZmlsZV9yZWN2X21heF9zaXplCi0gICAgICAgICAgICApCi0gICAg
ICAgICAgICByZXR1cm4gRmFsc2UKLQogICAgICAgICBpZiBsZW4obG9hZFsnZGF0YSddKSArIGxv
YWQuZ2V0KCdsb2MnLCAwKSA+IGZpbGVfcmVjdl9tYXhfc2l6ZToKICAgICAgICAgICAgIGxvZy5l
cnJvcigKLSAgICAgICAgICAgICAgICAnRXhjZWVkaW5nIGZpbGVfcmVjdl9tYXhfc2l6ZSBsaW1p
dDogJXMnLAotICAgICAgICAgICAgICAgIGZpbGVfcmVjdl9tYXhfc2l6ZQorICAgICAgICAgICAg
ICAgICdFeGNlZWRpbmcgZmlsZV9yZWN2X21heF9zaXplIGxpbWl0OiB7MH0nLmZvcm1hdCgKKyAg
ICAgICAgICAgICAgICAgICAgZmlsZV9yZWN2X21heF9zaXplCisgICAgICAgICAgICAgICAgKQog
ICAgICAgICAgICAgKQogICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICMgTm9ybWFs
aXplIFdpbmRvd3MgcGF0aHMKQEAgLTcyMiwxMCArNzI1LDEwIEBAIGNsYXNzIFJlbW90ZUZ1bmNz
KG9iamVjdCk6CiAgICAgICAgICAgICBtb2RlID0gJ2FiJwogICAgICAgICBlbHNlOgogICAgICAg
ICAgICAgbW9kZSA9ICd3YicKLSAgICAgICAgd2l0aCBzYWx0LnV0aWxzLmZpbGVzLmZvcGVuKGNw
YXRoLCBtb2RlKSBhcyBmcF86CisgICAgICAgIHdpdGggc2FsdC51dGlscy5mb3BlbihjcGF0aCwg
bW9kZSkgYXMgZnBfOgogICAgICAgICAgICAgaWYgbG9hZFsnbG9jJ106CiAgICAgICAgICAgICAg
ICAgZnBfLnNlZWsobG9hZFsnbG9jJ10pCi0gICAgICAgICAgICBmcF8ud3JpdGUoc2FsdC51dGls
cy5zdHJpbmd1dGlscy50b19zdHIobG9hZFsnZGF0YSddKSkKKyAgICAgICAgICAgIGZwXy53cml0
ZShsb2FkWydkYXRhJ10pCiAgICAgICAgIHJldHVybiBUcnVlCiAKICAgICBkZWYgX3BpbGxhcihz
ZWxmLCBsb2FkKToKQEAgLTczNSw3ICs3MzgsNyBAQCBjbGFzcyBSZW1vdGVGdW5jcyhvYmplY3Qp
OgogICAgICAgICBpZiBhbnkoa2V5IG5vdCBpbiBsb2FkIGZvciBrZXkgaW4gKCdpZCcsICdncmFp
bnMnKSk6CiAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICMgICAgICAgIHBpbGxhciA9IHNhbHQu
cGlsbGFyLlBpbGxhcigKLSAgICAgICAgbG9nLmRlYnVnKCdNYXN0ZXIgX3BpbGxhciB1c2luZyBl
eHQ6ICVzJywgbG9hZC5nZXQoJ2V4dCcpKQorICAgICAgICBsb2cuZGVidWcoJ01hc3RlciBfcGls
bGFyIHVzaW5nIGV4dDogezB9Jy5mb3JtYXQobG9hZC5nZXQoJ2V4dCcpKSkKICAgICAgICAgcGls
bGFyID0gc2FsdC5waWxsYXIuZ2V0X3BpbGxhcigKICAgICAgICAgICAgICAgICBzZWxmLm9wdHMs
CiAgICAgICAgICAgICAgICAgbG9hZFsnZ3JhaW5zJ10sCkBAIC03NDQsMTMgKzc0NywxMiBAQCBj
bGFzcyBSZW1vdGVGdW5jcyhvYmplY3QpOgogICAgICAgICAgICAgICAgIGxvYWQuZ2V0KCdleHQn
KSwKICAgICAgICAgICAgICAgICBzZWxmLm1taW5pb24uZnVuY3Rpb25zLAogICAgICAgICAgICAg
ICAgIHBpbGxhcl9vdmVycmlkZT1sb2FkLmdldCgncGlsbGFyX292ZXJyaWRlJywge30pKQotICAg
ICAgICBkYXRhID0gcGlsbGFyLmNvbXBpbGVfcGlsbGFyKCkKKyAgICAgICAgcGlsbGFyX2RpcnMg
PSB7fQorICAgICAgICBkYXRhID0gcGlsbGFyLmNvbXBpbGVfcGlsbGFyKHBpbGxhcl9kaXJzPXBp
bGxhcl9kaXJzKQogICAgICAgICBpZiBzZWxmLm9wdHMuZ2V0KCdtaW5pb25fZGF0YV9jYWNoZScs
IEZhbHNlKToKICAgICAgICAgICAgIHNlbGYuY2FjaGUuc3RvcmUoJ21pbmlvbnMvezB9Jy5mb3Jt
YXQobG9hZFsnaWQnXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJywKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgeydncmFpbnMnOiBsb2FkWydncmFpbnMnXSwgJ3Bp
bGxhcic6IGRhdGF9KQotICAgICAgICAgICAgaWYgc2VsZi5vcHRzLmdldCgnbWluaW9uX2RhdGFf
Y2FjaGVfZXZlbnRzJykgaXMgVHJ1ZToKLSAgICAgICAgICAgICAgICBzZWxmLmV2ZW50LmZpcmVf
ZXZlbnQoeydjb21tZW50JzogJ01pbmlvbiBkYXRhIGNhY2hlIHJlZnJlc2gnfSwgc2FsdC51dGls
cy5ldmVudC50YWdpZnkobG9hZFsnaWQnXSwgJ3JlZnJlc2gnLCAnbWluaW9uJykpCiAgICAgICAg
IHJldHVybiBkYXRhCiAKICAgICBkZWYgX21pbmlvbl9ldmVudChzZWxmLCBsb2FkKToKQEAgLTc3
MCw3ICs3NzIsNyBAQCBjbGFzcyBSZW1vdGVGdW5jcyhvYmplY3QpOgogICAgICAgICAgICAgICAg
ICAgICBldmVudF9kYXRhID0gZXZlbnQKICAgICAgICAgICAgICAgICBzZWxmLmV2ZW50LmZpcmVf
ZXZlbnQoZXZlbnRfZGF0YSwgZXZlbnRbJ3RhZyddKSAgIyBvbGQgZHVwIGV2ZW50CiAgICAgICAg
ICAgICAgICAgaWYgbG9hZC5nZXQoJ3ByZXRhZycpIGlzIG5vdCBOb25lOgotICAgICAgICAgICAg
ICAgICAgICBzZWxmLmV2ZW50LmZpcmVfZXZlbnQoZXZlbnRfZGF0YSwgc2FsdC51dGlscy5ldmVu
dC50YWdpZnkoZXZlbnRbJ3RhZyddLCBiYXNlPWxvYWRbJ3ByZXRhZyddKSkKKyAgICAgICAgICAg
ICAgICAgICAgc2VsZi5ldmVudC5maXJlX2V2ZW50KGV2ZW50X2RhdGEsIHRhZ2lmeShldmVudFsn
dGFnJ10sIGJhc2U9bG9hZFsncHJldGFnJ10pKQogICAgICAgICBlbHNlOgogICAgICAgICAgICAg
dGFnID0gbG9hZFsndGFnJ10KICAgICAgICAgICAgIHNlbGYuZXZlbnQuZmlyZV9ldmVudChsb2Fk
LCB0YWcpCkBAIC03ODEsNyArNzgzLDcgQEAgY2xhc3MgUmVtb3RlRnVuY3Mob2JqZWN0KToKICAg
ICAgICAgSGFuZGxlIHRoZSByZXR1cm4gZGF0YSBzZW50IGZyb20gdGhlIG1pbmlvbnMKICAgICAg
ICAgJycnCiAgICAgICAgICMgR2VuZXJhdGUgRW5kVGltZQotICAgICAgICBlbmR0aW1lID0gc2Fs
dC51dGlscy5qaWQuamlkX3RvX3RpbWUoc2FsdC51dGlscy5qaWQuZ2VuX2ppZChzZWxmLm9wdHMp
KQorICAgICAgICBlbmR0aW1lID0gc2FsdC51dGlscy5qaWQuamlkX3RvX3RpbWUoc2FsdC51dGls
cy5qaWQuZ2VuX2ppZCgpKQogICAgICAgICAjIElmIHRoZSByZXR1cm4gZGF0YSBpcyBpbnZhbGlk
LCBqdXN0IGlnbm9yZSBpdAogICAgICAgICBpZiBhbnkoa2V5IG5vdCBpbiBsb2FkIGZvciBrZXkg
aW4gKCdyZXR1cm4nLCAnamlkJywgJ2lkJykpOgogICAgICAgICAgICAgcmV0dXJuIEZhbHNlCkBA
IC03OTQsOSArNzk2LDkgQEAgY2xhc3MgUmVtb3RlRnVuY3Mob2JqZWN0KToKICAgICAgICAgICAg
ICMgc2F2ZSB0aGUgbG9hZCwgc2luY2Ugd2UgZG9uJ3QgaGF2ZSBpdAogICAgICAgICAgICAgc2F2
ZWxvYWRfZnN0ciA9ICd7MH0uc2F2ZV9sb2FkJy5mb3JtYXQoc2VsZi5vcHRzWydtYXN0ZXJfam9i
X2NhY2hlJ10pCiAgICAgICAgICAgICBzZWxmLm1taW5pb24ucmV0dXJuZXJzW3NhdmVsb2FkX2Zz
dHJdKGxvYWRbJ2ppZCddLCBsb2FkKQotICAgICAgICBsb2cuaW5mbygnR290IHJldHVybiBmcm9t
ICVzIGZvciBqb2IgJXMnLCBsb2FkWydpZCddLCBsb2FkWydqaWQnXSkKKyAgICAgICAgbG9nLmlu
Zm8oJ0dvdCByZXR1cm4gZnJvbSB7aWR9IGZvciBqb2Ige2ppZH0nLmZvcm1hdCgqKmxvYWQpKQog
ICAgICAgICBzZWxmLmV2ZW50LmZpcmVfZXZlbnQobG9hZCwgbG9hZFsnamlkJ10pICAjIG9sZCBk
dXAgZXZlbnQKLSAgICAgICAgc2VsZi5ldmVudC5maXJlX2V2ZW50KGxvYWQsIHNhbHQudXRpbHMu
ZXZlbnQudGFnaWZ5KFtsb2FkWydqaWQnXSwgJ3JldCcsIGxvYWRbJ2lkJ11dLCAnam9iJykpCisg
ICAgICAgIHNlbGYuZXZlbnQuZmlyZV9ldmVudChsb2FkLCB0YWdpZnkoW2xvYWRbJ2ppZCddLCAn
cmV0JywgbG9hZFsnaWQnXV0sICdqb2InKSkKICAgICAgICAgc2VsZi5ldmVudC5maXJlX3JldF9s
b2FkKGxvYWQpCiAgICAgICAgIGlmIG5vdCBzZWxmLm9wdHNbJ2pvYl9jYWNoZSddIG9yIHNlbGYu
b3B0cy5nZXQoJ2V4dF9qb2JfY2FjaGUnKToKICAgICAgICAgICAgIHJldHVybgpAQCAtODU0LDE1
ICs4NTYsMTcgQEAgY2xhc3MgUmVtb3RlRnVuY3Mob2JqZWN0KToKICAgICAgICAgaWYgbm90IGdv
b2Q6CiAgICAgICAgICAgICAjIFRoZSBtaW5pb24gaXMgbm90IHdobyBpdCBzYXlzIGl0IGlzIQog
ICAgICAgICAgICAgIyBXZSBkb24ndCB3YW50IHRvIGxpc3RlbiB0byBpdCEKLSAgICAgICAgICAg
IGxvZy53YXJuaW5nKCdNaW5pb24gaWQgJXMgaXMgbm90IHdobyBpdCBzYXlzIGl0IGlzIScsIGxv
YWRbJ2lkJ10pCisgICAgICAgICAgICBsb2cud2FybmluZygKKyAgICAgICAgICAgICAgICAgICAg
J01pbmlvbiBpZCB7MH0gaXMgbm90IHdobyBpdCBzYXlzIGl0IGlzIScuZm9ybWF0KAorICAgICAg
ICAgICAgICAgICAgICBsb2FkWydpZCddCisgICAgICAgICAgICAgICAgICAgICkKKyAgICAgICAg
ICAgICkKICAgICAgICAgICAgIHJldHVybiB7fQogICAgICAgICAjIFByZXBhcmUgdGhlIHJ1bm5l
ciBvYmplY3QKICAgICAgICAgb3B0cyA9IHt9CiAgICAgICAgIG9wdHMudXBkYXRlKHNlbGYub3B0
cykKICAgICAgICAgb3B0cy51cGRhdGUoeydmdW4nOiBsb2FkWydmdW4nXSwKLSAgICAgICAgICAg
ICAgICAnYXJnJzogc2FsdC51dGlscy5hcmdzLnBhcnNlX2lucHV0KAotICAgICAgICAgICAgICAg
ICAgICBsb2FkWydhcmcnXSwKLSAgICAgICAgICAgICAgICAgICAgbm9fcGFyc2U9bG9hZC5nZXQo
J25vX3BhcnNlJywgW10pKSwKKyAgICAgICAgICAgICAgICAnYXJnJzogbG9hZFsnYXJnJ10sCiAg
ICAgICAgICAgICAgICAgJ2lkJzogbG9hZFsnaWQnXSwKICAgICAgICAgICAgICAgICAnZG9jJzog
RmFsc2UsCiAgICAgICAgICAgICAgICAgJ2NvbmZfZmlsZSc6IHNlbGYub3B0c1snY29uZl9maWxl
J119KQpAQCAtODgzLDggKzg4Nyw4IEBAIGNsYXNzIFJlbW90ZUZ1bmNzKG9iamVjdCk6CiAgICAg
ICAgICAgICBpZiBub3Qgb3MucGF0aC5pc2RpcihhdXRoX2NhY2hlKToKICAgICAgICAgICAgICAg
ICBvcy5tYWtlZGlycyhhdXRoX2NhY2hlKQogICAgICAgICAgICAgamlkX2ZuID0gb3MucGF0aC5q
b2luKGF1dGhfY2FjaGUsIGxvYWRbJ2ppZCddKQotICAgICAgICAgICAgd2l0aCBzYWx0LnV0aWxz
LmZpbGVzLmZvcGVuKGppZF9mbiwgJ3InKSBhcyBmcF86Ci0gICAgICAgICAgICAgICAgaWYgbm90
IGxvYWRbJ2lkJ10gPT0gc2FsdC51dGlscy5zdHJpbmd1dGlscy50b191bmljb2RlKGZwXy5yZWFk
KCkpOgorICAgICAgICAgICAgd2l0aCBzYWx0LnV0aWxzLmZvcGVuKGppZF9mbiwgJ3InKSBhcyBm
cF86CisgICAgICAgICAgICAgICAgaWYgbm90IGxvYWRbJ2lkJ10gPT0gZnBfLnJlYWQoKToKICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9CiAKICAgICAgICAgICAgIHJldHVybiBzZWxmLmxv
Y2FsLmdldF9jYWNoZV9yZXR1cm5zKGxvYWRbJ2ppZCddKQpAQCAtOTEyLDEwICs5MTYsOCBAQCBj
bGFzcyBSZW1vdGVGdW5jcyhvYmplY3QpOgogICAgICAgICAjIFNldCB1cCB0aGUgcHVibGljYXRp
b24gcGF5bG9hZAogICAgICAgICBwdWJfbG9hZCA9IHsKICAgICAgICAgICAgICdmdW4nOiBsb2Fk
WydmdW4nXSwKLSAgICAgICAgICAgICdhcmcnOiBzYWx0LnV0aWxzLmFyZ3MucGFyc2VfaW5wdXQo
Ci0gICAgICAgICAgICAgICAgbG9hZFsnYXJnJ10sCi0gICAgICAgICAgICAgICAgbm9fcGFyc2U9
bG9hZC5nZXQoJ25vX3BhcnNlJywgW10pKSwKLSAgICAgICAgICAgICd0Z3RfdHlwZSc6IGxvYWQu
Z2V0KCd0Z3RfdHlwZScsICdnbG9iJyksCisgICAgICAgICAgICAnYXJnJzogbG9hZFsnYXJnJ10s
CisgICAgICAgICAgICAnZXhwcl9mb3JtJzogbG9hZC5nZXQoJ3RndF90eXBlJywgJ2dsb2InKSwK
ICAgICAgICAgICAgICd0Z3QnOiBsb2FkWyd0Z3QnXSwKICAgICAgICAgICAgICdyZXQnOiBsb2Fk
WydyZXQnXSwKICAgICAgICAgICAgICdpZCc6IGxvYWRbJ2lkJ10sCkBAIC05MjQsMjUgKzkyNiwy
NSBAQCBjbGFzcyBSZW1vdGVGdW5jcyhvYmplY3QpOgogICAgICAgICAgICAgaWYgbG9hZFsndGd0
X3R5cGUnXS5zdGFydHN3aXRoKCdub2RlJyk6CiAgICAgICAgICAgICAgICAgaWYgbG9hZFsndGd0
J10gaW4gc2VsZi5vcHRzWydub2RlZ3JvdXBzJ106CiAgICAgICAgICAgICAgICAgICAgIHB1Yl9s
b2FkWyd0Z3QnXSA9IHNlbGYub3B0c1snbm9kZWdyb3VwcyddW2xvYWRbJ3RndCddXQotICAgICAg
ICAgICAgICAgICAgICBwdWJfbG9hZFsndGd0X3R5cGUnXSA9ICdjb21wb3VuZCcKKyAgICAgICAg
ICAgICAgICAgICAgcHViX2xvYWRbJ2V4cHJfZm9ybV90eXBlJ10gPSAnY29tcG91bmQnCisgICAg
ICAgICAgICAgICAgICAgIHB1Yl9sb2FkWydleHByX2Zvcm0nXSA9IGxvYWRbJ3RndF90eXBlJ10K
ICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICByZXR1cm4ge30KICAg
ICAgICAgICAgIGVsc2U6Ci0gICAgICAgICAgICAgICAgcHViX2xvYWRbJ3RndF90eXBlJ10gPSBs
b2FkWyd0Z3RfdHlwZSddCisgICAgICAgICAgICAgICAgcHViX2xvYWRbJ2V4cHJfZm9ybSddID0g
bG9hZFsndGd0X3R5cGUnXQogICAgICAgICByZXQgPSB7fQogICAgICAgICByZXRbJ2ppZCddID0g
c2VsZi5sb2NhbC5jbWRfYXN5bmMoKipwdWJfbG9hZCkKLSAgICAgICAgX3JlcyA9IHNlbGYuY2tt
aW5pb25zLmNoZWNrX21pbmlvbnMoCisgICAgICAgIHJldFsnbWluaW9ucyddID0gc2VsZi5ja21p
bmlvbnMuY2hlY2tfbWluaW9ucygKICAgICAgICAgICAgICAgICBsb2FkWyd0Z3QnXSwKLSAgICAg
ICAgICAgICAgICBwdWJfbG9hZFsndGd0X3R5cGUnXSkKLSAgICAgICAgcmV0WydtaW5pb25zJ10g
PSBfcmVzWydtaW5pb25zJ10KKyAgICAgICAgICAgICAgICBwdWJfbG9hZFsnZXhwcl9mb3JtJ10p
CiAgICAgICAgIGF1dGhfY2FjaGUgPSBvcy5wYXRoLmpvaW4oCiAgICAgICAgICAgICAgICAgc2Vs
Zi5vcHRzWydjYWNoZWRpciddLAogICAgICAgICAgICAgICAgICdwdWJsaXNoX2F1dGgnKQogICAg
ICAgICBpZiBub3Qgb3MucGF0aC5pc2RpcihhdXRoX2NhY2hlKToKICAgICAgICAgICAgIG9zLm1h
a2VkaXJzKGF1dGhfY2FjaGUpCi0gICAgICAgIGppZF9mbiA9IG9zLnBhdGguam9pbihhdXRoX2Nh
Y2hlLCBzaXgudGV4dF90eXBlKHJldFsnamlkJ10pKQotICAgICAgICB3aXRoIHNhbHQudXRpbHMu
ZmlsZXMuZm9wZW4oamlkX2ZuLCAndysnKSBhcyBmcF86Ci0gICAgICAgICAgICBmcF8ud3JpdGUo
c2FsdC51dGlscy5zdHJpbmd1dGlscy50b19zdHIobG9hZFsnaWQnXSkpCisgICAgICAgIGppZF9m
biA9IG9zLnBhdGguam9pbihhdXRoX2NhY2hlLCBzdHIocmV0WydqaWQnXSkpCisgICAgICAgIHdp
dGggc2FsdC51dGlscy5mb3BlbihqaWRfZm4sICd3KycpIGFzIGZwXzoKKyAgICAgICAgICAgIGZw
Xy53cml0ZShsb2FkWydpZCddKQogICAgICAgICByZXR1cm4gcmV0CiAKICAgICBkZWYgbWluaW9u
X3B1Ymxpc2goc2VsZiwgbG9hZCk6CkBAIC05NjgsMTAgKzk3MCw4IEBAIGNsYXNzIFJlbW90ZUZ1
bmNzKG9iamVjdCk6CiAgICAgICAgICMgU2V0IHVwIHRoZSBwdWJsaWNhdGlvbiBwYXlsb2FkCiAg
ICAgICAgIHB1Yl9sb2FkID0gewogICAgICAgICAgICAgJ2Z1bic6IGxvYWRbJ2Z1biddLAotICAg
ICAgICAgICAgJ2FyZyc6IHNhbHQudXRpbHMuYXJncy5wYXJzZV9pbnB1dCgKLSAgICAgICAgICAg
ICAgICBsb2FkWydhcmcnXSwKLSAgICAgICAgICAgICAgICBub19wYXJzZT1sb2FkLmdldCgnbm9f
cGFyc2UnLCBbXSkpLAotICAgICAgICAgICAgJ3RndF90eXBlJzogbG9hZC5nZXQoJ3RndF90eXBl
JywgJ2dsb2InKSwKKyAgICAgICAgICAgICdhcmcnOiBsb2FkWydhcmcnXSwKKyAgICAgICAgICAg
ICdleHByX2Zvcm0nOiBsb2FkLmdldCgndGd0X3R5cGUnLCAnZ2xvYicpLAogICAgICAgICAgICAg
J3RndCc6IGxvYWRbJ3RndCddLAogICAgICAgICAgICAgJ3JldCc6IGxvYWRbJ3JldCddLAogICAg
ICAgICAgICAgJ2lkJzogbG9hZFsnaWQnXSwKQEAgLTk5NiwxMSArOTk2LDExIEBAIGNsYXNzIFJl
bW90ZUZ1bmNzKG9iamVjdCk6CiAgICAgICAgICAgICBpZiBsb2FkWyd0Z3RfdHlwZSddLnN0YXJ0
c3dpdGgoJ25vZGUnKToKICAgICAgICAgICAgICAgICBpZiBsb2FkWyd0Z3QnXSBpbiBzZWxmLm9w
dHNbJ25vZGVncm91cHMnXToKICAgICAgICAgICAgICAgICAgICAgcHViX2xvYWRbJ3RndCddID0g
c2VsZi5vcHRzWydub2RlZ3JvdXBzJ11bbG9hZFsndGd0J11dCi0gICAgICAgICAgICAgICAgICAg
IHB1Yl9sb2FkWyd0Z3RfdHlwZSddID0gJ2NvbXBvdW5kJworICAgICAgICAgICAgICAgICAgICBw
dWJfbG9hZFsnZXhwcl9mb3JtX3R5cGUnXSA9ICdjb21wb3VuZCcKICAgICAgICAgICAgICAgICBl
bHNlOgogICAgICAgICAgICAgICAgICAgICByZXR1cm4ge30KICAgICAgICAgICAgIGVsc2U6Ci0g
ICAgICAgICAgICAgICAgcHViX2xvYWRbJ3RndF90eXBlJ10gPSBsb2FkWyd0Z3RfdHlwZSddCisg
ICAgICAgICAgICAgICAgcHViX2xvYWRbJ2V4cHJfZm9ybSddID0gbG9hZFsndGd0X3R5cGUnXQog
ICAgICAgICBwdWJfbG9hZFsncmF3J10gPSBUcnVlCiAgICAgICAgIHJldCA9IHt9CiAgICAgICAg
IGZvciBtaW5pb24gaW4gc2VsZi5sb2NhbC5jbWRfaXRlcigqKnB1Yl9sb2FkKToKQEAgLTEwNzEs
MTA2ICsxMDcxLDIzMyBAQCBjbGFzcyBMb2NhbEZ1bmNzKG9iamVjdCk6CiAgICAgICAgICcnJwog
ICAgICAgICBTZW5kIGEgbWFzdGVyIGNvbnRyb2wgZnVuY3Rpb24gYmFjayB0byB0aGUgcnVubmVy
IHN5c3RlbQogICAgICAgICAnJycKLSAgICAgICAgIyBBbGwgcnVubmVyIG9wdHMgcGFzcyB0aHJv
dWdoIGVhdXRoCi0gICAgICAgIGF1dGhfdHlwZSwgZXJyX25hbWUsIGtleSA9IHNlbGYuX3ByZXBf
YXV0aF9pbmZvKGxvYWQpCi0KLSAgICAgICAgIyBBdXRoZW50aWNhdGUKLSAgICAgICAgYXV0aF9j
aGVjayA9IHNlbGYubG9hZGF1dGguY2hlY2tfYXV0aGVudGljYXRpb24obG9hZCwgYXV0aF90eXBl
KQotICAgICAgICBlcnJvciA9IGF1dGhfY2hlY2suZ2V0KCdlcnJvcicpCi0KLSAgICAgICAgaWYg
ZXJyb3I6Ci0gICAgICAgICAgICAjIEF1dGhlbnRpY2F0aW9uIGVycm9yIG9jY3VycmVkOiBkbyBu
b3QgY29udGludWUuCi0gICAgICAgICAgICByZXR1cm4geydlcnJvcic6IGVycm9yfQotCi0gICAg
ICAgICMgQXV0aG9yaXplCi0gICAgICAgIHJ1bm5lcl9jaGVjayA9IHNlbGYuY2ttaW5pb25zLnJ1
bm5lcl9jaGVjaygKLSAgICAgICAgICAgIGF1dGhfY2hlY2suZ2V0KCdhdXRoX2xpc3QnLCBbXSks
Ci0gICAgICAgICAgICBsb2FkWydmdW4nXSwKLSAgICAgICAgICAgIGxvYWRbJ2t3YXJnJ10KLSAg
ICAgICAgKQotICAgICAgICB1c2VybmFtZSA9IGF1dGhfY2hlY2suZ2V0KCd1c2VybmFtZScpCi0g
ICAgICAgIGlmIG5vdCBydW5uZXJfY2hlY2s6Ci0gICAgICAgICAgICByZXR1cm4geydlcnJvcic6
IHsnbmFtZSc6IGVycl9uYW1lLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21lc3Nh
Z2UnOiAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ7MH0iIG9jY3VycmVkICcKLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvciB1c2VyIHsxfS4nLmZv
cm1hdChhdXRoX3R5cGUsIHVzZXJuYW1lKX19Ci0gICAgICAgIGVsaWYgaXNpbnN0YW5jZShydW5u
ZXJfY2hlY2ssIGRpY3QpIGFuZCAnZXJyb3InIGluIHJ1bm5lcl9jaGVjazoKLSAgICAgICAgICAg
ICMgQSBkaWN0aW9uYXJ5IHdpdGggYW4gZXJyb3IgbmFtZS9tZXNzYWdlIHdhcyBoYW5kbGVkIGJ5
IGNrbWluaW9ucy5ydW5uZXJfY2hlY2sKLSAgICAgICAgICAgIHJldHVybiBydW5uZXJfY2hlY2sK
LQotICAgICAgICAjIEF1dGhvcml6ZWQuIERvIHRoZSBqb2IhCisgICAgICAgIGlmICd0b2tlbicg
aW4gbG9hZDoKKyAgICAgICAgICAgIHRyeToKKyAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYu
bG9hZGF1dGguZ2V0X3Rvayhsb2FkWyd0b2tlbiddKQorICAgICAgICAgICAgZXhjZXB0IEV4Y2Vw
dGlvbiBhcyBleGM6CisgICAgICAgICAgICAgICAgbXNnID0gJ0V4Y2VwdGlvbiBvY2N1cnJlZCB3
aGVuIGdlbmVyYXRpbmcgYXV0aCB0b2tlbjogezB9Jy5mb3JtYXQoCisgICAgICAgICAgICAgICAg
ICAgICAgICBleGMpCisgICAgICAgICAgICAgICAgbG9nLmVycm9yKG1zZykKKyAgICAgICAgICAg
ICAgICByZXR1cm4gZGljdChlcnJvcj1kaWN0KG5hbWU9J1Rva2VuQXV0aGVudGljYXRpb25FcnJv
cicsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlPW1zZykp
CisgICAgICAgICAgICBpZiBub3QgdG9rZW46CisgICAgICAgICAgICAgICAgbXNnID0gJ0F1dGhl
bnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAidG9rZW4iIG9jY3VycmVkLicKKyAgICAgICAgICAg
ICAgICBsb2cud2FybmluZyhtc2cpCisgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9
ZGljdChuYW1lPSdUb2tlbkF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZT1tc2cpKQorICAgICAgICAgICAgaWYgdG9rZW5b
J2VhdXRoJ10gbm90IGluIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddOgorICAgICAgICAgICAg
ICAgIG1zZyA9ICdBdXRoZW50aWNhdGlvbiBmYWlsdXJlIG9mIHR5cGUgInRva2VuIiBvY2N1cnJl
ZC4nCisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQorICAgICAgICAgICAgICAgIHJl
dHVybiBkaWN0KGVycm9yPWRpY3QobmFtZT0nVG9rZW5BdXRoZW50aWNhdGlvbkVycm9yJywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKyAgICAg
ICAgICAgIGdvb2QgPSBzZWxmLmNrbWluaW9ucy5ydW5uZXJfY2hlY2soCisgICAgICAgICAgICAg
ICAgICAgIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW3Rva2VuWydlYXV0aCddXVt0b2tlblsn
bmFtZSddXQorICAgICAgICAgICAgICAgICAgICBpZiB0b2tlblsnbmFtZSddIGluIHNlbGYub3B0
c1snZXh0ZXJuYWxfYXV0aCddW3Rva2VuWydlYXV0aCddXQorICAgICAgICAgICAgICAgICAgICBl
bHNlIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW3Rva2VuWydlYXV0aCddXVsnKiddLAorICAg
ICAgICAgICAgICAgICAgICBsb2FkWydmdW4nXSkKKyAgICAgICAgICAgIGlmIG5vdCBnb29kOgor
ICAgICAgICAgICAgICAgIG1zZyA9ICgnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ0
b2tlbiIgb2NjdXJyZWQgZm9yICcKKyAgICAgICAgICAgICAgICAgICAgICAgJ3VzZXIgezB9Licp
LmZvcm1hdCh0b2tlblsnbmFtZSddKQorICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKG1zZykK
KyAgICAgICAgICAgICAgICByZXR1cm4gZGljdChlcnJvcj1kaWN0KG5hbWU9J1Rva2VuQXV0aGVu
dGljYXRpb25FcnJvcicsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBt
ZXNzYWdlPW1zZykpCisKKyAgICAgICAgICAgIHRyeToKKyAgICAgICAgICAgICAgICBmdW4gPSBs
b2FkLnBvcCgnZnVuJykKKyAgICAgICAgICAgICAgICBydW5uZXJfY2xpZW50ID0gc2FsdC5ydW5u
ZXIuUnVubmVyQ2xpZW50KHNlbGYub3B0cykKKyAgICAgICAgICAgICAgICByZXR1cm4gcnVubmVy
X2NsaWVudC5hc3luYygKKyAgICAgICAgICAgICAgICAgICAgICAgIGZ1biwKKyAgICAgICAgICAg
ICAgICAgICAgICAgIGxvYWQuZ2V0KCdrd2FyZycsIHt9KSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgIHRva2VuWyduYW1lJ10pCisgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGV4YzoK
KyAgICAgICAgICAgICAgICBsb2cuZXJyb3IoJ0V4Y2VwdGlvbiBvY2N1cnJlZCB3aGlsZSAnCisg
ICAgICAgICAgICAgICAgICAgICAgICAnaW50cm9zcGVjdGluZyB7MH06IHsxfScuZm9ybWF0KGZ1
biwgZXhjKSkKKyAgICAgICAgICAgICAgICByZXR1cm4gZGljdChlcnJvcj1kaWN0KG5hbWU9ZXhj
Ll9fY2xhc3NfXy5fX25hbWVfXywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGFyZ3M9ZXhjLmFyZ3MsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1lc3NhZ2U9c3RyKGV4YykpKQorCisgICAgICAgIGlmICdlYXV0aCcgbm90IGluIGxvYWQ6Cisg
ICAgICAgICAgICBtc2cgPSAoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgi
IG9jY3VycmVkIGZvciAnCisgICAgICAgICAgICAgICAgICAgJ3VzZXIgezB9LicpLmZvcm1hdChs
b2FkLmdldCgndXNlcm5hbWUnLCAnVU5LTk9XTicpKQorICAgICAgICAgICAgbG9nLndhcm5pbmco
bXNnKQorICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1lPSdFYXV0aEF1dGhl
bnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNz
YWdlPW1zZykpCisgICAgICAgIGlmIGxvYWRbJ2VhdXRoJ10gbm90IGluIHNlbGYub3B0c1snZXh0
ZXJuYWxfYXV0aCddOgorICAgICAgICAgICAgIyBUaGUgZWF1dGggc3lzdGVtIGlzIG5vdCBlbmFi
bGVkLCBmYWlsCisgICAgICAgICAgICBtc2cgPSAoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2Yg
dHlwZSAiZWF1dGgiIG9jY3VycmVkIGZvciAnCisgICAgICAgICAgICAgICAgICAgJ3VzZXIgezB9
LicpLmZvcm1hdChsb2FkLmdldCgndXNlcm5hbWUnLCAnVU5LTk9XTicpKQorICAgICAgICAgICAg
bG9nLndhcm5pbmcobXNnKQorICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1l
PSdFYXV0aEF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBtZXNzYWdlPW1zZykpCisKICAgICAgICAgdHJ5OgotICAgICAgICAgICAgZnVuID0g
bG9hZC5wb3AoJ2Z1bicpCi0gICAgICAgICAgICBydW5uZXJfY2xpZW50ID0gc2FsdC5ydW5uZXIu
UnVubmVyQ2xpZW50KHNlbGYub3B0cykKLSAgICAgICAgICAgIHJldHVybiBydW5uZXJfY2xpZW50
LmFzeW5jKGZ1biwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQu
Z2V0KCdrd2FyZycsIHt9KSwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVzZXJuYW1lKQorICAgICAgICAgICAgbmFtZSA9IHNlbGYubG9hZGF1dGgubG9hZF9uYW1lKGxv
YWQpCisgICAgICAgICAgICBpZiBub3QgKG5hbWUgaW4gc2VsZi5vcHRzWydleHRlcm5hbF9hdXRo
J11bbG9hZFsnZWF1dGgnXV0pIHwgKCcqJyBpbiBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVts
b2FkWydlYXV0aCddXSk6CisgICAgICAgICAgICAgICAgbXNnID0gKCdBdXRoZW50aWNhdGlvbiBm
YWlsdXJlIG9mIHR5cGUgImVhdXRoIiBvY2N1cnJlZCBmb3IgJworICAgICAgICAgICAgICAgICAg
ICAgICAndXNlciB7MH0uJykuZm9ybWF0KGxvYWQuZ2V0KCd1c2VybmFtZScsICdVTktOT1dOJykp
CisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQorICAgICAgICAgICAgICAgIHJldHVy
biBkaWN0KGVycm9yPWRpY3QobmFtZT0nRWF1dGhBdXRoZW50aWNhdGlvbkVycm9yJywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKyAgICAgICAg
ICAgIGlmIG5vdCBzZWxmLmxvYWRhdXRoLnRpbWVfYXV0aChsb2FkKToKKyAgICAgICAgICAgICAg
ICBtc2cgPSAoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9jY3VycmVk
IGZvciAnCisgICAgICAgICAgICAgICAgICAgICAgICd1c2VyIHswfS4nKS5mb3JtYXQobG9hZC5n
ZXQoJ3VzZXJuYW1lJywgJ1VOS05PV04nKSkKKyAgICAgICAgICAgICAgICBsb2cud2FybmluZyht
c2cpCisgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1lPSdFYXV0aEF1
dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgbWVzc2FnZT1tc2cpKQorICAgICAgICAgICAgZ29vZCA9IHNlbGYuY2ttaW5pb25zLnJ1bm5l
cl9jaGVjaygKKyAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRzWydleHRlcm5hbF9hdXRoJ11b
bG9hZFsnZWF1dGgnXV1bbmFtZV0gaWYgbmFtZSBpbiBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgn
XVtsb2FkWydlYXV0aCddXSBlbHNlIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW2xvYWRbJ2Vh
dXRoJ11dWycqJ10sCisgICAgICAgICAgICAgICAgICAgIGxvYWRbJ2Z1biddKQorICAgICAgICAg
ICAgaWYgbm90IGdvb2Q6CisgICAgICAgICAgICAgICAgbXNnID0gKCdBdXRoZW50aWNhdGlvbiBm
YWlsdXJlIG9mIHR5cGUgImVhdXRoIiBvY2N1cnJlZCBmb3IgJworICAgICAgICAgICAgICAgICAg
ICAgICAndXNlciB7MH0uJykuZm9ybWF0KGxvYWQuZ2V0KCd1c2VybmFtZScsICdVTktOT1dOJykp
CisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQorICAgICAgICAgICAgICAgIHJldHVy
biBkaWN0KGVycm9yPWRpY3QobmFtZT0nRWF1dGhBdXRoZW50aWNhdGlvbkVycm9yJywKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKworICAgICAg
ICAgICAgdHJ5OgorICAgICAgICAgICAgICAgIGZ1biA9IGxvYWQucG9wKCdmdW4nKQorICAgICAg
ICAgICAgICAgIHJ1bm5lcl9jbGllbnQgPSBzYWx0LnJ1bm5lci5SdW5uZXJDbGllbnQoc2VsZi5v
cHRzKQorICAgICAgICAgICAgICAgIHJldHVybiBydW5uZXJfY2xpZW50LmFzeW5jKGZ1biwKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkLmdldCgna3dhcmcn
LCB7fSksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZC5n
ZXQoJ3VzZXJuYW1lJywgJ1VOS05PV04nKSkKKyAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZXhjOgorICAgICAgICAgICAgICAgIGxvZy5lcnJvcignRXhjZXB0aW9uIG9jY3VycmVkIHdo
aWxlICcKKyAgICAgICAgICAgICAgICAgICAgICAgICdpbnRyb3NwZWN0aW5nIHswfTogezF9Jy5m
b3JtYXQoZnVuLCBleGMpKQorICAgICAgICAgICAgICAgIHJldHVybiBkaWN0KGVycm9yPWRpY3Qo
bmFtZT1leGMuX19jbGFzc19fLl9fbmFtZV9fLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYXJncz1leGMuYXJncywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIG1lc3NhZ2U9c3RyKGV4YykpKQorCiAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24g
YXMgZXhjOgotICAgICAgICAgICAgbG9nLmV4Y2VwdGlvbignRXhjZXB0aW9uIG9jY3VycmVkIHdo
aWxlIGludHJvc3BlY3RpbmcgJXMnKQotICAgICAgICAgICAgcmV0dXJuIHsnZXJyb3InOiB7J25h
bWUnOiBleGMuX19jbGFzc19fLl9fbmFtZV9fLAotICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgJ2FyZ3MnOiBleGMuYXJncywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtZXNz
YWdlJzogc2l4LnRleHRfdHlwZShleGMpfX0KKyAgICAgICAgICAgIGxvZy5lcnJvcigKKyAgICAg
ICAgICAgICAgICAnRXhjZXB0aW9uIG9jY3VycmVkIGluIHRoZSBydW5uZXIgc3lzdGVtOiB7MH0n
LmZvcm1hdChleGMpCisgICAgICAgICAgICApCisgICAgICAgICAgICByZXR1cm4gZGljdChlcnJv
cj1kaWN0KG5hbWU9ZXhjLl9fY2xhc3NfXy5fX25hbWVfXywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYXJncz1leGMuYXJncywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgbWVzc2FnZT1zdHIoZXhjKSkpCiAKICAgICBkZWYgd2hlZWwoc2VsZiwgbG9hZCk6
CiAgICAgICAgICcnJwogICAgICAgICBTZW5kIGEgbWFzdGVyIGNvbnRyb2wgZnVuY3Rpb24gYmFj
ayB0byB0aGUgd2hlZWwgc3lzdGVtCiAgICAgICAgICcnJwogICAgICAgICAjIEFsbCB3aGVlbCBv
cHMgcGFzcyB0aHJvdWdoIGVhdXRoCi0gICAgICAgIGF1dGhfdHlwZSwgZXJyX25hbWUsIGtleSA9
IHNlbGYuX3ByZXBfYXV0aF9pbmZvKGxvYWQpCi0KLSAgICAgICAgIyBBdXRoZW50aWNhdGUKLSAg
ICAgICAgYXV0aF9jaGVjayA9IHNlbGYubG9hZGF1dGguY2hlY2tfYXV0aGVudGljYXRpb24oCi0g
ICAgICAgICAgICBsb2FkLAotICAgICAgICAgICAgYXV0aF90eXBlLAotICAgICAgICAgICAga2V5
PWtleSwKLSAgICAgICAgICAgIHNob3dfdXNlcm5hbWU9VHJ1ZQotICAgICAgICApCi0gICAgICAg
IGVycm9yID0gYXV0aF9jaGVjay5nZXQoJ2Vycm9yJykKLQotICAgICAgICBpZiBlcnJvcjoKLSAg
ICAgICAgICAgICMgQXV0aGVudGljYXRpb24gZXJyb3Igb2NjdXJyZWQ6IGRvIG5vdCBjb250aW51
ZS4KLSAgICAgICAgICAgIHJldHVybiB7J2Vycm9yJzogZXJyb3J9CisgICAgICAgIGlmICd0b2tl
bicgaW4gbG9hZDoKKyAgICAgICAgICAgIGF0eXBlID0gJ3Rva2VuJworICAgICAgICAgICAgdHJ5
OgorICAgICAgICAgICAgICAgIHRva2VuID0gc2VsZi5sb2FkYXV0aC5nZXRfdG9rKGxvYWRbJ3Rv
a2VuJ10pCisgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGV4YzoKKyAgICAgICAgICAg
ICAgICBtc2cgPSAnRXhjZXB0aW9uIG9jY3VycmVkIHdoZW4gZ2VuZXJhdGluZyBhdXRoIHRva2Vu
OiB7MH0nLmZvcm1hdCgKKyAgICAgICAgICAgICAgICAgICAgICAgIGV4YykKKyAgICAgICAgICAg
ICAgICBsb2cuZXJyb3IobXNnKQorICAgICAgICAgICAgICAgIHJldHVybiBkaWN0KGVycm9yPWRp
Y3QobmFtZT0nVG9rZW5BdXRoZW50aWNhdGlvbkVycm9yJywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKyAgICAgICAgICAgIGlmIG5vdCB0b2tl
bjoKKyAgICAgICAgICAgICAgICBtc2cgPSAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBl
ICJ0b2tlbiIgb2NjdXJyZWQuJworICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKG1zZykKKyAg
ICAgICAgICAgICAgICByZXR1cm4gZGljdChlcnJvcj1kaWN0KG5hbWU9J1Rva2VuQXV0aGVudGlj
YXRpb25FcnJvcicsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNz
YWdlPW1zZykpCisgICAgICAgICAgICBpZiB0b2tlblsnZWF1dGgnXSBub3QgaW4gc2VsZi5vcHRz
WydleHRlcm5hbF9hdXRoJ106CisgICAgICAgICAgICAgICAgbXNnID0gJ0F1dGhlbnRpY2F0aW9u
IGZhaWx1cmUgb2YgdHlwZSAidG9rZW4iIG9jY3VycmVkLicKKyAgICAgICAgICAgICAgICBsb2cu
d2FybmluZyhtc2cpCisgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1l
PSdUb2tlbkF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgbWVzc2FnZT1tc2cpKQorICAgICAgICAgICAgdXNlcm5hbWUgPSB0b2tlblsn
bmFtZSddCisgICAgICAgIGVsaWYgJ2VhdXRoJyBpbiBsb2FkOgorICAgICAgICAgICAgYXR5cGUg
PSAnZWF1dGgnCisgICAgICAgICAgICB0cnk6CisgICAgICAgICAgICAgICAgaWYgbG9hZFsnZWF1
dGgnXSBub3QgaW4gc2VsZi5vcHRzWydleHRlcm5hbF9hdXRoJ106CisgICAgICAgICAgICAgICAg
ICAgICMgVGhlIGVhdXRoIHN5c3RlbSBpcyBub3QgZW5hYmxlZCwgZmFpbAorICAgICAgICAgICAg
ICAgICAgICBtc2cgPSAoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9j
Y3VycmVkIGZvciAnCisgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlciB7MH0uJykuZm9y
bWF0KGxvYWQuZ2V0KCd1c2VybmFtZScsICdVTktOT1dOJykpCisgICAgICAgICAgICAgICAgICAg
IGxvZy53YXJuaW5nKG1zZykKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9
ZGljdChuYW1lPSdFYXV0aEF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKworICAgICAgICAgICAgICAg
IHVzZXJuYW1lID0gc2VsZi5sb2FkYXV0aC5sb2FkX25hbWUobG9hZCkKKyAgICAgICAgICAgICAg
ICBpZiBub3QgKCh1c2VybmFtZSBpbiBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVtsb2FkWydl
YXV0aCddXSkgfAorICAgICAgICAgICAgICAgICAgICAgICAgKCcqJyBpbiBzZWxmLm9wdHNbJ2V4
dGVybmFsX2F1dGgnXVtsb2FkWydlYXV0aCddXSkpOgorICAgICAgICAgICAgICAgICAgICBtc2cg
PSAoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9jY3VycmVkIGZvciAn
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlciB7MH0uJykuZm9ybWF0KGxvYWQuZ2V0
KCd1c2VybmFtZScsICdVTktOT1dOJykpCisgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuaW5n
KG1zZykKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1lPSdF
YXV0aEF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG1lc3NhZ2U9bXNnKSkKKyAgICAgICAgICAgICAgICBpZiBub3Qgc2VsZi5s
b2FkYXV0aC50aW1lX2F1dGgobG9hZCk6CisgICAgICAgICAgICAgICAgICAgIG1zZyA9ICgnQXV0
aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJlYXV0aCIgb2NjdXJyZWQgZm9yICcKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICd1c2VyIHswfS4nKS5mb3JtYXQobG9hZC5nZXQoJ3VzZXJu
YW1lJywgJ1VOS05PV04nKSkKKyAgICAgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQor
ICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGljdChlcnJvcj1kaWN0KG5hbWU9J0VhdXRoQXV0
aGVudGljYXRpb25FcnJvcicsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbWVzc2FnZT1tc2cpKQorICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBleGM6
CisgICAgICAgICAgICAgICAgbG9nLmVycm9yKAorICAgICAgICAgICAgICAgICAgICAnRXhjZXB0
aW9uIG9jY3VycmVkIGluIHRoZSB3aGVlbCBzeXN0ZW06IHswfScuZm9ybWF0KGV4YykKKyAgICAg
ICAgICAgICAgICApCisgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1l
PWV4Yy5fX2NsYXNzX18uX19uYW1lX18sCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhcmdzPWV4Yy5hcmdzLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgbWVzc2FnZT1zdHIoZXhjKSkpCisgICAgICAgIGVsc2U6CisgICAgICAgICAgICBhdHlw
ZSA9ICd1c2VyJworICAgICAgICAgICAgaWYgJ2tleScgbm90IGluIGxvYWQ6CisgICAgICAgICAg
ICAgICAgbXNnID0gJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAidXNlciIgb2NjdXJy
ZWQnCisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQorICAgICAgICAgICAgICAgIHJl
dHVybiBkaWN0KGVycm9yPWRpY3QobmFtZT0nVXNlckF1dGhlbnRpY2F0aW9uRXJyb3InLAorICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZT1tc2cpKQorICAgICAg
ICAgICAga2V5ID0gbG9hZC5wb3AoJ2tleScpCisKKyAgICAgICAgICAgIGlmICd1c2VyJyBpbiBs
b2FkOgorICAgICAgICAgICAgICAgIHVzZXJuYW1lID0gbG9hZFsndXNlciddCisgICAgICAgICAg
ICAgICAgYXV0aF91c2VyID0gc2FsdC5hdXRoLkF1dGhVc2VyKHVzZXJuYW1lKQorICAgICAgICAg
ICAgICAgIGlmIGF1dGhfdXNlci5pc19zdWRvOgorICAgICAgICAgICAgICAgICAgICB1c2VybmFt
ZSA9IHNlbGYub3B0cy5nZXQoJ3VzZXInLCAncm9vdCcpCisgICAgICAgICAgICBlbHNlOgorICAg
ICAgICAgICAgICAgIHVzZXJuYW1lID0gc2FsdC51dGlscy5nZXRfdXNlcigpCiAKLSAgICAgICAg
IyBBdXRob3JpemUKLSAgICAgICAgdXNlcm5hbWUgPSBhdXRoX2NoZWNrLmdldCgndXNlcm5hbWUn
KQotICAgICAgICBpZiBhdXRoX3R5cGUgIT0gJ3VzZXInOgotICAgICAgICAgICAgd2hlZWxfY2hl
Y2sgPSBzZWxmLmNrbWluaW9ucy53aGVlbF9jaGVjaygKLSAgICAgICAgICAgICAgICBhdXRoX2No
ZWNrLmdldCgnYXV0aF9saXN0JywgW10pLAotICAgICAgICAgICAgICAgIGxvYWRbJ2Z1biddLAot
ICAgICAgICAgICAgICAgIGxvYWRbJ2t3YXJnJ10KLSAgICAgICAgICAgICkKLSAgICAgICAgICAg
IGlmIG5vdCB3aGVlbF9jaGVjazoKLSAgICAgICAgICAgICAgICByZXR1cm4geydlcnJvcic6IHsn
bmFtZSc6IGVycl9uYW1lLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtZXNz
YWdlJzogJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiezB9IiBvY2N1cnJlZCBmb3Ig
JwotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3VzZXIgezF9
LicuZm9ybWF0KGF1dGhfdHlwZSwgdXNlcm5hbWUpfX0KLSAgICAgICAgICAgIGVsaWYgaXNpbnN0
YW5jZSh3aGVlbF9jaGVjaywgZGljdCkgYW5kICdlcnJvcicgaW4gd2hlZWxfY2hlY2s6Ci0gICAg
ICAgICAgICAgICAgIyBBIGRpY3Rpb25hcnkgd2l0aCBhbiBlcnJvciBuYW1lL21lc3NhZ2Ugd2Fz
IGhhbmRsZWQgYnkgY2ttaW5pb25zLndoZWVsX2NoZWNrCi0gICAgICAgICAgICAgICAgcmV0dXJu
IHdoZWVsX2NoZWNrCisgICAgICAgICAgICBpZiB1c2VybmFtZSBub3QgaW4gc2VsZi5rZXkgYW5k
IFwKKyAgICAgICAgICAgICAgICAgICAga2V5ICE9IHNlbGYua2V5W3VzZXJuYW1lXSBhbmQgXAor
ICAgICAgICAgICAgICAgICAgICBrZXkgIT0gc2VsZi5rZXlbJ3Jvb3QnXToKKyAgICAgICAgICAg
ICAgICBtc2cgPSAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ1c2VyIiBvY2N1cnJl
ZCBmb3IgdXNlciB7MH0nLmZvcm1hdCh1c2VybmFtZSkKKyAgICAgICAgICAgICAgICBsb2cud2Fy
bmluZyhtc2cpCisgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3QoZXJyb3I9ZGljdChuYW1lPSdV
c2VyQXV0aGVudGljYXRpb25FcnJvcicsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBtZXNzYWdlPW1zZykpCisKKyAgICAgICAgaWYgbm90IGF0eXBlID09ICd1c2VyJzoK
KyAgICAgICAgICAgIGF1dGhfbGlzdCA9IFtdCisgICAgICAgICAgICBpZiAnKicgaW4gc2VsZi5v
cHRzWydleHRlcm5hbF9hdXRoJ11bbG9hZFsnZWF1dGgnXV06CisgICAgICAgICAgICAgICAgYXV0
aF9saXN0LmV4dGVuZChzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVtsb2FkWydlYXV0aCddXVsn
KiddKQorICAgICAgICAgICAgaWYgdXNlcm5hbWUgaW4gc2VsZi5vcHRzWydleHRlcm5hbF9hdXRo
J11bbG9hZFsnZWF1dGgnXV06CisgICAgICAgICAgICAgICAgYXV0aF9saXN0ID0gc2VsZi5vcHRz
WydleHRlcm5hbF9hdXRoJ11bbG9hZFsnZWF1dGgnXV1bdXNlcm5hbWVdCisgICAgICAgICAgICBn
b29kID0gc2VsZi5ja21pbmlvbnMud2hlZWxfY2hlY2soYXV0aF9saXN0LCBsb2FkWydmdW4nXSkK
KyAgICAgICAgICAgIGlmIG5vdCBnb29kOgorICAgICAgICAgICAgICAgIG1zZyA9ICgnQXV0aGVu
dGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ7MH0iIG9jY3VycmVkIGZvciAnCisgICAgICAgICAg
ICAgICAgICAgICAgICd1c2VyIHsxfS4nKS5mb3JtYXQoYXR5cGUsIGxvYWQuZ2V0KCd1c2VybmFt
ZScsICdVTktOT1dOJykpCisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcobXNnKQorICAgICAg
ICAgICAgICAgIHJldHVybiBkaWN0KGVycm9yPWRpY3QobmFtZT0nRWF1dGhBdXRoZW50aWNhdGlv
bkVycm9yJywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U9
bXNnKSkKIAogICAgICAgICAjIEF1dGhlbnRpY2F0ZWQuIERvIHRoZSBqb2IuCi0gICAgICAgIGpp
ZCA9IHNhbHQudXRpbHMuamlkLmdlbl9qaWQoc2VsZi5vcHRzKQorICAgICAgICBqaWQgPSBzYWx0
LnV0aWxzLmppZC5nZW5famlkKCkKICAgICAgICAgZnVuID0gbG9hZC5wb3AoJ2Z1bicpCi0gICAg
ICAgIHRhZyA9IHNhbHQudXRpbHMuZXZlbnQudGFnaWZ5KGppZCwgcHJlZml4PSd3aGVlbCcpCisg
ICAgICAgIHRhZyA9IHRhZ2lmeShqaWQsIHByZWZpeD0nd2hlZWwnKQogICAgICAgICBkYXRhID0g
eydmdW4nOiAid2hlZWwuezB9Ii5mb3JtYXQoZnVuKSwKICAgICAgICAgICAgICAgICAnamlkJzog
amlkLAogICAgICAgICAgICAgICAgICd0YWcnOiB0YWcsCiAgICAgICAgICAgICAgICAgJ3VzZXIn
OiB1c2VybmFtZX0KICAgICAgICAgdHJ5OgotICAgICAgICAgICAgc2VsZi5ldmVudC5maXJlX2V2
ZW50KGRhdGEsIHNhbHQudXRpbHMuZXZlbnQudGFnaWZ5KFtqaWQsICduZXcnXSwgJ3doZWVsJykp
CisgICAgICAgICAgICBzZWxmLmV2ZW50LmZpcmVfZXZlbnQoZGF0YSwgdGFnaWZ5KFtqaWQsICdu
ZXcnXSwgJ3doZWVsJykpCiAgICAgICAgICAgICByZXQgPSBzZWxmLndoZWVsXy5jYWxsX2Z1bmMo
ZnVuLCAqKmxvYWQpCiAgICAgICAgICAgICBkYXRhWydyZXR1cm4nXSA9IHJldAogICAgICAgICAg
ICAgZGF0YVsnc3VjY2VzcyddID0gVHJ1ZQotICAgICAgICAgICAgc2VsZi5ldmVudC5maXJlX2V2
ZW50KGRhdGEsIHNhbHQudXRpbHMuZXZlbnQudGFnaWZ5KFtqaWQsICdyZXQnXSwgJ3doZWVsJykp
CisgICAgICAgICAgICBzZWxmLmV2ZW50LmZpcmVfZXZlbnQoZGF0YSwgdGFnaWZ5KFtqaWQsICdy
ZXQnXSwgJ3doZWVsJykpCiAgICAgICAgICAgICByZXR1cm4geyd0YWcnOiB0YWcsCiAgICAgICAg
ICAgICAgICAgICAgICdkYXRhJzogZGF0YX0KICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBl
eGM6Ci0gICAgICAgICAgICBsb2cuZXhjZXB0aW9uKCdFeGNlcHRpb24gb2NjdXJyZWQgd2hpbGUg
aW50cm9zcGVjdGluZyAlcycsIGZ1bikKKyAgICAgICAgICAgIGxvZy5lcnJvcignRXhjZXB0aW9u
IG9jY3VycmVkIHdoaWxlICcKKyAgICAgICAgICAgICAgICAgICAgJ2ludHJvc3BlY3RpbmcgezB9
OiB7MX0nLmZvcm1hdChmdW4sIGV4YykpCiAgICAgICAgICAgICBkYXRhWydyZXR1cm4nXSA9ICdF
eGNlcHRpb24gb2NjdXJyZWQgaW4gd2hlZWwgezB9OiB7MX06IHsyfScuZm9ybWF0KAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1biwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBleGMuX19jbGFzc19fLl9fbmFtZV9fLAogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4YywKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICBkYXRhWydzdWNjZXNzJ10gPSBGYWxz
ZQotICAgICAgICAgICAgc2VsZi5ldmVudC5maXJlX2V2ZW50KGRhdGEsIHNhbHQudXRpbHMuZXZl
bnQudGFnaWZ5KFtqaWQsICdyZXQnXSwgJ3doZWVsJykpCisgICAgICAgICAgICBzZWxmLmV2ZW50
LmZpcmVfZXZlbnQoZGF0YSwgdGFnaWZ5KFtqaWQsICdyZXQnXSwgJ3doZWVsJykpCiAgICAgICAg
ICAgICByZXR1cm4geyd0YWcnOiB0YWcsCiAgICAgICAgICAgICAgICAgICAgICdkYXRhJzogZGF0
YX0KIApAQCAtMTE3OSwxMSArMTMwNiwyOCBAQCBjbGFzcyBMb2NhbEZ1bmNzKG9iamVjdCk6CiAg
ICAgICAgIENyZWF0ZSBhbmQgcmV0dXJuIGFuIGF1dGhlbnRpY2F0aW9uIHRva2VuLCB0aGUgY2xl
YXIgbG9hZCBuZWVkcyB0bwogICAgICAgICBjb250YWluIHRoZSBlYXV0aCBrZXkgYW5kIHRoZSBu
ZWVkZWQgYXV0aGVudGljYXRpb24gY3JlZHMuCiAgICAgICAgICcnJwotICAgICAgICB0b2tlbiA9
IHNlbGYubG9hZGF1dGgubWtfdG9rZW4obG9hZCkKLSAgICAgICAgaWYgbm90IHRva2VuOgorICAg
ICAgICBpZiAnZWF1dGgnIG5vdCBpbiBsb2FkOgorICAgICAgICAgICAgbG9nLndhcm5pbmcoJ0F1
dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9jY3VycmVkLicpCisgICAgICAg
ICAgICByZXR1cm4gJycKKyAgICAgICAgaWYgbG9hZFsnZWF1dGgnXSBub3QgaW4gc2VsZi5vcHRz
WydleHRlcm5hbF9hdXRoJ106CisgICAgICAgICAgICAjIFRoZSBlYXV0aCBzeXN0ZW0gaXMgbm90
IGVuYWJsZWQsIGZhaWwKICAgICAgICAgICAgIGxvZy53YXJuaW5nKCdBdXRoZW50aWNhdGlvbiBm
YWlsdXJlIG9mIHR5cGUgImVhdXRoIiBvY2N1cnJlZC4nKQogICAgICAgICAgICAgcmV0dXJuICcn
Ci0gICAgICAgIHJldHVybiB0b2tlbgorICAgICAgICB0cnk6CisgICAgICAgICAgICBuYW1lID0g
c2VsZi5sb2FkYXV0aC5sb2FkX25hbWUobG9hZCkKKyAgICAgICAgICAgIGlmIG5vdCAoKG5hbWUg
aW4gc2VsZi5vcHRzWydleHRlcm5hbF9hdXRoJ11bbG9hZFsnZWF1dGgnXV0pIHwKKyAgICAgICAg
ICAgICAgICAgICAgKCcqJyBpbiBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVtsb2FkWydlYXV0
aCddXSkpOgorICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKCdBdXRoZW50aWNhdGlvbiBmYWls
dXJlIG9mIHR5cGUgImVhdXRoIiBvY2N1cnJlZC4nKQorICAgICAgICAgICAgICAgIHJldHVybiAn
JworICAgICAgICAgICAgaWYgbm90IHNlbGYubG9hZGF1dGgudGltZV9hdXRoKGxvYWQpOgorICAg
ICAgICAgICAgICAgIGxvZy53YXJuaW5nKCdBdXRoZW50aWNhdGlvbiBmYWlsdXJlIG9mIHR5cGUg
ImVhdXRoIiBvY2N1cnJlZC4nKQorICAgICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAg
ICAgcmV0dXJuIHNlbGYubG9hZGF1dGgubWtfdG9rZW4obG9hZCkKKyAgICAgICAgZXhjZXB0IEV4
Y2VwdGlvbiBhcyBleGM6CisgICAgICAgICAgICBsb2cuZXJyb3IoCisgICAgICAgICAgICAgICAg
J0V4Y2VwdGlvbiBvY2N1cnJlZCB3aGlsZSBhdXRoZW50aWNhdGluZzogezB9Jy5mb3JtYXQoZXhj
KQorICAgICAgICAgICAgKQorICAgICAgICAgICAgcmV0dXJuICcnCiAKICAgICBkZWYgZ2V0X3Rv
a2VuKHNlbGYsIGxvYWQpOgogICAgICAgICAnJycKQEAgLTEyMDAsNzQgKzEzNDQsMTkzIEBAIGNs
YXNzIExvY2FsRnVuY3Mob2JqZWN0KToKICAgICAgICAgJycnCiAgICAgICAgIGV4dHJhID0gbG9h
ZC5nZXQoJ2t3YXJncycsIHt9KQogCi0gICAgICAgIHB1Ymxpc2hlcl9hY2wgPSBzYWx0LmFjbC5Q
dWJsaXNoZXJBQ0woc2VsZi5vcHRzWydwdWJsaXNoZXJfYWNsX2JsYWNrbGlzdCddKQorICAgICAg
ICAjIGNoZWNrIGJsYWNrbGlzdC93aGl0ZWxpc3QKKyAgICAgICAgIyBDaGVjayBpZiB0aGUgdXNl
ciBpcyBibGFja2xpc3RlZAorICAgICAgICBpZiBzZWxmLm9wdHNbJ2NsaWVudF9hY2wnXSBvciBz
ZWxmLm9wdHNbJ2NsaWVudF9hY2xfYmxhY2tsaXN0J106CisgICAgICAgICAgICBzYWx0LnV0aWxz
Lndhcm5fdW50aWwoCisgICAgICAgICAgICAgICAgICAgICdOaXRyb2dlbicsCisgICAgICAgICAg
ICAgICAgICAgICdBQ0wgcnVsZXMgc2hvdWxkIGJlIGNvbmZpZ3VyZWQgd2l0aCBcJ3B1Ymxpc2hl
cl9hY2xcJyBhbmQgJworICAgICAgICAgICAgICAgICAgICAnXCdwdWJsaXNoZXJfYWNsX2JsYWNr
bGlzdFwnIG5vdCBcJ2NsaWVudF9hY2xcJyBhbmQgXCdjbGllbnRfYWNsX2JsYWNrbGlzdFwnLiAn
CisgICAgICAgICAgICAgICAgICAgICdUaGlzIGZ1bmN0aW9uYWxpdHkgd2lsbCBiZSByZW1vdmVk
IGluIFNhbHQgTml0cm9nZW4uJworICAgICAgICAgICAgICAgICAgICApCisKKyAgICAgICAgcHVi
bGlzaGVyX2FjbCA9IHNhbHQuYWNsLlB1Ymxpc2hlckFDTCgKKyAgICAgICAgICAgICAgICBzZWxm
Lm9wdHNbJ3B1Ymxpc2hlcl9hY2xfYmxhY2tsaXN0J10gb3Igc2VsZi5vcHRzWydjbGllbnRfYWNs
X2JsYWNrbGlzdCddKQorICAgICAgICBnb29kID0gbm90IHB1Ymxpc2hlcl9hY2wudXNlcl9pc19i
bGFja2xpc3RlZChsb2FkWyd1c2VyJ10pIGFuZCBcCisgICAgICAgICAgICAgICAgbm90IHB1Ymxp
c2hlcl9hY2wuY21kX2lzX2JsYWNrbGlzdGVkKGxvYWRbJ2Z1biddKQogCi0gICAgICAgIGlmIHB1
Ymxpc2hlcl9hY2wudXNlcl9pc19ibGFja2xpc3RlZChsb2FkWyd1c2VyJ10pIG9yIFwKLSAgICAg
ICAgICAgICAgICBwdWJsaXNoZXJfYWNsLmNtZF9pc19ibGFja2xpc3RlZChsb2FkWydmdW4nXSk6
CisgICAgICAgIGlmIGdvb2QgaXMgRmFsc2U6CiAgICAgICAgICAgICBsb2cuZXJyb3IoCi0gICAg
ICAgICAgICAgICAgJyVzIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbnMgdG8gcnVuICVzLiBQbGVh
c2UgY29udGFjdCAnCi0gICAgICAgICAgICAgICAgJ3lvdXIgbG9jYWwgYWRtaW5pc3RyYXRvciBp
ZiB5b3UgYmVsaWV2ZSB0aGlzIGlzIGluIGVycm9yLicsCi0gICAgICAgICAgICAgICAgbG9hZFsn
dXNlciddLCBsb2FkWydmdW4nXQorICAgICAgICAgICAgICAgICd7dXNlcn0gZG9lcyBub3QgaGF2
ZSBwZXJtaXNzaW9ucyB0byBydW4ge2Z1bmN0aW9ufS4gUGxlYXNlICcKKyAgICAgICAgICAgICAg
ICAnY29udGFjdCB5b3VyIGxvY2FsIGFkbWluaXN0cmF0b3IgaWYgeW91IGJlbGlldmUgdGhpcyBp
cyBpbiAnCisgICAgICAgICAgICAgICAgJ2Vycm9yLlxuJy5mb3JtYXQoCisgICAgICAgICAgICAg
ICAgICAgIHVzZXI9bG9hZFsndXNlciddLAorICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbj1s
b2FkWydmdW4nXQorICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICkKLSAgICAgICAgICAg
IHJldHVybiB7J2Vycm9yJzogeyduYW1lJzogJ0F1dGhvcml6YXRpb25FcnJvcicsCi0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZSc6ICdBdXRob3JpemF0aW9uIGVycm9yIG9j
Y3VycmVkLid9fQotCi0gICAgICAgICMgUmV0cmlldmUgdGhlIG1pbmlvbnMgbGlzdAotICAgICAg
ICBkZWxpbWl0ZXIgPSBsb2FkLmdldCgna3dhcmdzJywge30pLmdldCgnZGVsaW1pdGVyJywgREVG
QVVMVF9UQVJHRVRfREVMSU0pCi0gICAgICAgIF9yZXMgPSBzZWxmLmNrbWluaW9ucy5jaGVja19t
aW5pb25zKAotICAgICAgICAgICAgbG9hZFsndGd0J10sCi0gICAgICAgICAgICBsb2FkLmdldCgn
dGd0X3R5cGUnLCAnZ2xvYicpLAotICAgICAgICAgICAgZGVsaW1pdGVyCi0gICAgICAgICkKLSAg
ICAgICAgbWluaW9ucyA9IF9yZXNbJ21pbmlvbnMnXQorICAgICAgICAgICAgcmV0dXJuICcnCisg
ICAgICAgICMgdG8gbWFrZSBzdXJlIHdlIGRvbid0IHN0ZXAgb24gYW55b25lIGVsc2UncyB0b2Vz
CisgICAgICAgIGRlbCBnb29kCiAKLSAgICAgICAgIyBDaGVjayBmb3IgZXh0ZXJuYWwgYXV0aCBj
YWxscyBhbmQgYXV0aGVudGljYXRlCi0gICAgICAgIGF1dGhfdHlwZSwgZXJyX25hbWUsIGtleSA9
IHNlbGYuX3ByZXBfYXV0aF9pbmZvKGV4dHJhKQotICAgICAgICBpZiBhdXRoX3R5cGUgPT0gJ3Vz
ZXInOgotICAgICAgICAgICAgYXV0aF9jaGVjayA9IHNlbGYubG9hZGF1dGguY2hlY2tfYXV0aGVu
dGljYXRpb24obG9hZCwgYXV0aF90eXBlLCBrZXk9a2V5KQorICAgICAgICAjIENoZWNrIGZvciBl
eHRlcm5hbCBhdXRoIGNhbGxzCisgICAgICAgIGlmIGV4dHJhLmdldCgndG9rZW4nLCBGYWxzZSk6
CisgICAgICAgICAgICAjIEEgdG9rZW4gd2FzIHBhc3NlZCwgY2hlY2sgaXQKKyAgICAgICAgICAg
IHRyeToKKyAgICAgICAgICAgICAgICB0b2tlbiA9IHNlbGYubG9hZGF1dGguZ2V0X3RvayhleHRy
YVsndG9rZW4nXSkKKyAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZXhjOgorICAgICAg
ICAgICAgICAgIGxvZy5lcnJvcigKKyAgICAgICAgICAgICAgICAgICAgJ0V4Y2VwdGlvbiBvY2N1
cnJlZCB3aGVuIGdlbmVyYXRpbmcgYXV0aCB0b2tlbjogezB9Jy5mb3JtYXQoCisgICAgICAgICAg
ICAgICAgICAgICAgICBleGMKKyAgICAgICAgICAgICAgICAgICAgKQorICAgICAgICAgICAgICAg
ICkKKyAgICAgICAgICAgICAgICByZXR1cm4gJycKKyAgICAgICAgICAgIGlmIG5vdCB0b2tlbjoK
KyAgICAgICAgICAgICAgICBsb2cud2FybmluZygnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0
eXBlICJ0b2tlbiIgb2NjdXJyZWQuIFwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb2tl
biBjb3VsZCBub3QgYmUgcmV0cmlldmVkLicpCisgICAgICAgICAgICAgICAgcmV0dXJuICcnCisg
ICAgICAgICAgICBpZiB0b2tlblsnZWF1dGgnXSBub3QgaW4gc2VsZi5vcHRzWydleHRlcm5hbF9h
dXRoJ106CisgICAgICAgICAgICAgICAgbG9nLndhcm5pbmcoJ0F1dGhlbnRpY2F0aW9uIGZhaWx1
cmUgb2YgdHlwZSAidG9rZW4iIG9jY3VycmVkLiBcCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgQXV0aGVudGljYXRpb24gdHlwZSBvZiB7MH0gbm90IHByZXNlbnQuJykuZm9ybWF0KHRva2Vu
WydlYXV0aCddKQorICAgICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAgICAgaWYgbm90
ICgodG9rZW5bJ25hbWUnXSBpbiBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVt0b2tlblsnZWF1
dGgnXV0pIHwKKyAgICAgICAgICAgICAgICAgICAgKCcqJyBpbiBzZWxmLm9wdHNbJ2V4dGVybmFs
X2F1dGgnXVt0b2tlblsnZWF1dGgnXV0pKToKKyAgICAgICAgICAgICAgICBsb2cud2FybmluZygn
QXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ0b2tlbiIgb2NjdXJyZWQuIFwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBUb2tlbiBkb2VzIG5vdCB2ZXJpZnkgYWdhaW5zdCBlYXV0
aCBwcm92aWRlcjogezB9JykuZm9ybWF0KAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2VsZi5vcHRzWydleHRlcm5hbF9hdXRoJ10pCisgICAgICAgICAgICAgICAgcmV0dXJu
ICcnCisgICAgICAgICAgICBnb29kID0gc2VsZi5ja21pbmlvbnMuYXV0aF9jaGVjaygKKyAgICAg
ICAgICAgICAgICAgICAgc2VsZi5vcHRzWydleHRlcm5hbF9hdXRoJ11bdG9rZW5bJ2VhdXRoJ11d
W3Rva2VuWyduYW1lJ11dCisgICAgICAgICAgICAgICAgICAgICAgICBpZiB0b2tlblsnbmFtZSdd
IGluIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW3Rva2VuWydlYXV0aCddXQorICAgICAgICAg
ICAgICAgICAgICAgICAgZWxzZSBzZWxmLm9wdHNbJ2V4dGVybmFsX2F1dGgnXVt0b2tlblsnZWF1
dGgnXV1bJyonXSwKKyAgICAgICAgICAgICAgICAgICAgbG9hZFsnZnVuJ10sCisgICAgICAgICAg
ICAgICAgICAgIGxvYWRbJ2FyZyddLAorICAgICAgICAgICAgICAgICAgICBsb2FkWyd0Z3QnXSwK
KyAgICAgICAgICAgICAgICAgICAgbG9hZC5nZXQoJ3RndF90eXBlJywgJ2dsb2InKSkKKyAgICAg
ICAgICAgIGlmIG5vdCBnb29kOgorICAgICAgICAgICAgICAgICMgQWNjZXB0IGZpbmRfam9iIHNv
IHRoZSBDTEkgd2lsbCBmdW5jdGlvbiBjbGVhbmx5CisgICAgICAgICAgICAgICAgaWYgbG9hZFsn
ZnVuJ10gIT0gJ3NhbHR1dGlsLmZpbmRfam9iJzoKKyAgICAgICAgICAgICAgICAgICAgbG9nLndh
cm5pbmcoCisgICAgICAgICAgICAgICAgICAgICAgICAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBv
ZiB0eXBlICJ0b2tlbiIgb2NjdXJyZWQuJworICAgICAgICAgICAgICAgICAgICApCisgICAgICAg
ICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAgICAgbG9hZFsndXNlciddID0gdG9rZW5b
J25hbWUnXQorICAgICAgICAgICAgbG9nLmRlYnVnKCdNaW5pb24gdG9rZW5pemVkIHVzZXIgPSAi
ezB9IicuZm9ybWF0KGxvYWRbJ3VzZXInXSkpCisgICAgICAgIGVsaWYgJ2VhdXRoJyBpbiBleHRy
YToKKyAgICAgICAgICAgIGlmIGV4dHJhWydlYXV0aCddIG5vdCBpbiBzZWxmLm9wdHNbJ2V4dGVy
bmFsX2F1dGgnXToKKyAgICAgICAgICAgICAgICAjIFRoZSBlYXV0aCBzeXN0ZW0gaXMgbm90IGVu
YWJsZWQsIGZhaWwKKyAgICAgICAgICAgICAgICBsb2cud2FybmluZygKKyAgICAgICAgICAgICAg
ICAgICAgJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9jY3VycmVkLicK
KyAgICAgICAgICAgICAgICApCisgICAgICAgICAgICAgICAgcmV0dXJuICcnCisgICAgICAgICAg
ICB0cnk6CisgICAgICAgICAgICAgICAgbmFtZSA9IHNlbGYubG9hZGF1dGgubG9hZF9uYW1lKGV4
dHJhKQorICAgICAgICAgICAgICAgIGlmIG5vdCAoKG5hbWUgaW4gc2VsZi5vcHRzWydleHRlcm5h
bF9hdXRoJ11bZXh0cmFbJ2VhdXRoJ11dKSB8CisgICAgICAgICAgICAgICAgICAgICAgICAoJyon
IGluIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW2V4dHJhWydlYXV0aCddXSkpOgorICAgICAg
ICAgICAgICAgICAgICBsb2cud2FybmluZygKKyAgICAgICAgICAgICAgICAgICAgICAgICdBdXRo
ZW50aWNhdGlvbiBmYWlsdXJlIG9mIHR5cGUgImVhdXRoIiBvY2N1cnJlZC4nCisgICAgICAgICAg
ICAgICAgICAgICkKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnCisgICAgICAgICAgICAg
ICAgaWYgbm90IHNlbGYubG9hZGF1dGgudGltZV9hdXRoKGV4dHJhKToKKyAgICAgICAgICAgICAg
ICAgICAgbG9nLndhcm5pbmcoCisgICAgICAgICAgICAgICAgICAgICAgICAnQXV0aGVudGljYXRp
b24gZmFpbHVyZSBvZiB0eXBlICJlYXV0aCIgb2NjdXJyZWQuJworICAgICAgICAgICAgICAgICAg
ICApCisgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAgICAgZXhjZXB0IEV4
Y2VwdGlvbiBhcyBleGM6CisgICAgICAgICAgICAgICAgbG9nLmVycm9yKAorICAgICAgICAgICAg
ICAgICAgICAnRXhjZXB0aW9uIG9jY3VycmVkIHdoaWxlIGF1dGhlbnRpY2F0aW5nOiB7MH0nLmZv
cm1hdChleGMpCisgICAgICAgICAgICAgICAgKQorICAgICAgICAgICAgICAgIHJldHVybiAnJwor
ICAgICAgICAgICAgZ29vZCA9IHNlbGYuY2ttaW5pb25zLmF1dGhfY2hlY2soCisgICAgICAgICAg
ICAgICAgICAgIHNlbGYub3B0c1snZXh0ZXJuYWxfYXV0aCddW2V4dHJhWydlYXV0aCddXVtuYW1l
XQorICAgICAgICAgICAgICAgICAgICAgICAgaWYgbmFtZSBpbiBzZWxmLm9wdHNbJ2V4dGVybmFs
X2F1dGgnXVtleHRyYVsnZWF1dGgnXV0KKyAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Ugc2Vs
Zi5vcHRzWydleHRlcm5hbF9hdXRoJ11bZXh0cmFbJ2VhdXRoJ11dWycqJ10sCisgICAgICAgICAg
ICAgICAgICAgIGxvYWRbJ2Z1biddLAorICAgICAgICAgICAgICAgICAgICBsb2FkWydhcmcnXSwK
KyAgICAgICAgICAgICAgICAgICAgbG9hZFsndGd0J10sCisgICAgICAgICAgICAgICAgICAgIGxv
YWQuZ2V0KCd0Z3RfdHlwZScsICdnbG9iJykpCisgICAgICAgICAgICBpZiBub3QgZ29vZDoKKyAg
ICAgICAgICAgICAgICAjIEFjY2VwdCBmaW5kX2pvYiBzbyB0aGUgQ0xJIHdpbGwgZnVuY3Rpb24g
Y2xlYW5seQorICAgICAgICAgICAgICAgIGlmIGxvYWRbJ2Z1biddICE9ICdzYWx0dXRpbC5maW5k
X2pvYic6CisgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKAorICAgICAgICAgICAgICAg
ICAgICAgICAgJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAiZWF1dGgiIG9jY3VycmVk
LicKKyAgICAgICAgICAgICAgICAgICAgKQorICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycK
KyAgICAgICAgICAgIGxvYWRbJ3VzZXInXSA9IG5hbWUKKyAgICAgICAgIyBWZXJpZnkgdGhhdCB0
aGUgY2FsbGVyIGhhcyByb290IG9uIG1hc3RlcgorICAgICAgICBlbGlmICd1c2VyJyBpbiBsb2Fk
OgorICAgICAgICAgICAgaWYgbG9hZFsndXNlciddLnN0YXJ0c3dpdGgoJ3N1ZG9fJyk6CisgICAg
ICAgICAgICAgICAgIyBJZiBzb21lb25lIGNhbiBzdWRvLCBhbGxvdyB0aGVtIHRvIGFjdCBhcyBy
b290CisgICAgICAgICAgICAgICAgaWYgbG9hZC5nZXQoJ2tleScsICdpbnZhbGlkJykgPT0gc2Vs
Zi5rZXkuZ2V0KCdyb290Jyk6CisgICAgICAgICAgICAgICAgICAgIGxvYWQucG9wKCdrZXknKQor
ICAgICAgICAgICAgICAgIGVsaWYgbG9hZC5wb3AoJ2tleScpICE9IHNlbGYua2V5W3NlbGYub3B0
cy5nZXQoJ3VzZXInLCAncm9vdCcpXToKKyAgICAgICAgICAgICAgICAgICAgbG9nLndhcm5pbmco
CisgICAgICAgICAgICAgICAgICAgICAgICAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBl
ICJ1c2VyIiBvY2N1cnJlZC4nCisgICAgICAgICAgICAgICAgICAgICkKKyAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuICcnCisgICAgICAgICAgICBlbGlmIGxvYWRbJ3VzZXInXSA9PSBzZWxmLm9w
dHMuZ2V0KCd1c2VyJywgJ3Jvb3QnKToKKyAgICAgICAgICAgICAgICBpZiBsb2FkLnBvcCgna2V5
JykgIT0gc2VsZi5rZXlbc2VsZi5vcHRzLmdldCgndXNlcicsICdyb290JyldOgorICAgICAgICAg
ICAgICAgICAgICBsb2cud2FybmluZygKKyAgICAgICAgICAgICAgICAgICAgICAgICdBdXRoZW50
aWNhdGlvbiBmYWlsdXJlIG9mIHR5cGUgInVzZXIiIG9jY3VycmVkLicKKyAgICAgICAgICAgICAg
ICAgICAgKQorICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKKyAgICAgICAgICAgIGVsaWYg
bG9hZFsndXNlciddID09ICdyb290JzoKKyAgICAgICAgICAgICAgICBpZiBsb2FkLnBvcCgna2V5
JykgIT0gc2VsZi5rZXkuZ2V0KHNlbGYub3B0cy5nZXQoJ3VzZXInLCAncm9vdCcpKToKKyAgICAg
ICAgICAgICAgICAgICAgbG9nLndhcm5pbmcoCisgICAgICAgICAgICAgICAgICAgICAgICAnQXV0
aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ1c2VyIiBvY2N1cnJlZC4nCisgICAgICAgICAg
ICAgICAgICAgICkKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnCisgICAgICAgICAgICBl
bGlmIGxvYWRbJ3VzZXInXSA9PSBzYWx0LnV0aWxzLmdldF91c2VyKCk6CisgICAgICAgICAgICAg
ICAgaWYgbG9hZC5wb3AoJ2tleScpICE9IHNlbGYua2V5LmdldChsb2FkWyd1c2VyJ10pOgorICAg
ICAgICAgICAgICAgICAgICBsb2cud2FybmluZygKKyAgICAgICAgICAgICAgICAgICAgICAgICdB
dXRoZW50aWNhdGlvbiBmYWlsdXJlIG9mIHR5cGUgInVzZXIiIG9jY3VycmVkLicKKyAgICAgICAg
ICAgICAgICAgICAgKQorICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKKyAgICAgICAgICAg
IGVsc2U6CisgICAgICAgICAgICAgICAgaWYgbG9hZFsndXNlciddIGluIHNlbGYua2V5OgorICAg
ICAgICAgICAgICAgICAgICAjIFVzZXIgaXMgYXV0aG9yaXNlZCwgY2hlY2sga2V5IGFuZCBjaGVj
ayBwZXJtcworICAgICAgICAgICAgICAgICAgICBpZiBsb2FkLnBvcCgna2V5JykgIT0gc2VsZi5r
ZXlbbG9hZFsndXNlciddXToKKyAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKAor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBdXRoZW50aWNhdGlvbiBmYWlsdXJlIG9mIHR5
cGUgInVzZXIiIG9jY3VycmVkLicKKyAgICAgICAgICAgICAgICAgICAgICAgICkKKyAgICAgICAg
ICAgICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAgICAgICAgICAgICBhY2wgPSBzYWx0
LnV0aWxzLmdldF92YWx1ZXNfb2ZfbWF0Y2hpbmdfa2V5cygKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzZWxmLm9wdHNbJ3B1Ymxpc2hlcl9hY2wnXSBvciBzZWxmLm9wdHNbJ2NsaWVudF9h
Y2wnXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkWyd1c2VyJ10pCisgICAgICAg
ICAgICAgICAgICAgIGlmIGxvYWRbJ3VzZXInXSBub3QgaW4gYWNsOgorICAgICAgICAgICAgICAg
ICAgICAgICAgbG9nLndhcm5pbmcoCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0F1dGhl
bnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAidXNlciIgb2NjdXJyZWQuJworICAgICAgICAgICAg
ICAgICAgICAgICAgKQorICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnCisgICAgICAg
ICAgICAgICAgICAgIGdvb2QgPSBzZWxmLmNrbWluaW9ucy5hdXRoX2NoZWNrKAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGFjbCwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2Fk
WydmdW4nXSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkWydhcmcnXSwKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBsb2FkWyd0Z3QnXSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBsb2FkLmdldCgndGd0X3R5cGUnLCAnZ2xvYicpKQorICAgICAgICAgICAgICAgICAg
ICBpZiBub3QgZ29vZDoKKyAgICAgICAgICAgICAgICAgICAgICAgICMgQWNjZXB0IGZpbmRfam9i
IHNvIHRoZSBDTEkgd2lsbCBmdW5jdGlvbiBjbGVhbmx5CisgICAgICAgICAgICAgICAgICAgICAg
ICBpZiBsb2FkWydmdW4nXSAhPSAnc2FsdHV0aWwuZmluZF9qb2InOgorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGxvZy53YXJuaW5nKAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ1c2VyIiAnCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICdvY2N1cnJlZC4nCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKQorICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJworICAgICAgICAgICAg
ICAgIGVsc2U6CisgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuaW5nKAorICAgICAgICAgICAg
ICAgICAgICAgICAgJ0F1dGhlbnRpY2F0aW9uIGZhaWx1cmUgb2YgdHlwZSAidXNlciIgb2NjdXJy
ZWQuJworICAgICAgICAgICAgICAgICAgICApCisgICAgICAgICAgICAgICAgICAgIHJldHVybiAn
JwogICAgICAgICBlbHNlOgotICAgICAgICAgICAgYXV0aF9jaGVjayA9IHNlbGYubG9hZGF1dGgu
Y2hlY2tfYXV0aGVudGljYXRpb24oZXh0cmEsIGF1dGhfdHlwZSkKLQotICAgICAgICAjIFNldHVw
IGF1dGhvcml6YXRpb24gbGlzdCB2YXJpYWJsZSBhbmQgZXJyb3IgaW5mb3JtYXRpb24KLSAgICAg
ICAgYXV0aF9saXN0ID0gYXV0aF9jaGVjay5nZXQoJ2F1dGhfbGlzdCcsIFtdKQotICAgICAgICBl
cnJvciA9IGF1dGhfY2hlY2suZ2V0KCdlcnJvcicpCi0gICAgICAgIGVycl9tc2cgPSAnQXV0aGVu
dGljYXRpb24gZmFpbHVyZSBvZiB0eXBlICJ7MH0iIG9jY3VycmVkLicuZm9ybWF0KGF1dGhfdHlw
ZSkKLQotICAgICAgICBpZiBlcnJvcjoKLSAgICAgICAgICAgICMgQXV0aGVudGljYXRpb24gZXJy
b3Igb2NjdXJyZWQ6IGRvIG5vdCBjb250aW51ZS4KLSAgICAgICAgICAgIGxvZy53YXJuaW5nKGVy
cl9tc2cpCi0gICAgICAgICAgICByZXR1cm4geydlcnJvcic6IHsnbmFtZSc6ICdBdXRoZW50aWNh
dGlvbkVycm9yJywKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJzogJ0F1
dGhlbnRpY2F0aW9uIGVycm9yIG9jY3VycmVkLid9fQotCi0gICAgICAgICMgQWxsIFRva2VuLCBF
YXV0aCwgYW5kIG5vbi1yb290IHVzZXJzIG11c3QgcGFzcyB0aGUgYXV0aG9yaXphdGlvbiBjaGVj
awotICAgICAgICBpZiBhdXRoX3R5cGUgIT0gJ3VzZXInIG9yIChhdXRoX3R5cGUgPT0gJ3VzZXIn
IGFuZCBhdXRoX2xpc3QpOgotICAgICAgICAgICAgIyBBdXRob3JpemUgdGhlIHJlcXVlc3QKLSAg
ICAgICAgICAgIGF1dGhvcml6ZWQgPSBzZWxmLmNrbWluaW9ucy5hdXRoX2NoZWNrKAotICAgICAg
ICAgICAgICAgIGF1dGhfbGlzdCwKLSAgICAgICAgICAgICAgICBsb2FkWydmdW4nXSwKLSAgICAg
ICAgICAgICAgICBsb2FkWydhcmcnXSwKKyAgICAgICAgICAgIGlmIGxvYWQucG9wKCdrZXknKSAh
PSBzZWxmLmtleVtzYWx0LnV0aWxzLmdldF91c2VyKCldOgorICAgICAgICAgICAgICAgIGxvZy53
YXJuaW5nKAorICAgICAgICAgICAgICAgICAgICAnQXV0aGVudGljYXRpb24gZmFpbHVyZSBvZiB0
eXBlICJvdGhlciIgb2NjdXJyZWQuJworICAgICAgICAgICAgICAgICkKKyAgICAgICAgICAgICAg
ICByZXR1cm4gJycKKyAgICAgICAgIyBSZXRyaWV2ZSB0aGUgbWluaW9ucyBsaXN0CisgICAgICAg
IG1pbmlvbnMgPSBzZWxmLmNrbWluaW9ucy5jaGVja19taW5pb25zKAogICAgICAgICAgICAgICAg
IGxvYWRbJ3RndCddLAotICAgICAgICAgICAgICAgIGxvYWQuZ2V0KCd0Z3RfdHlwZScsICdnbG9i
JyksCi0gICAgICAgICAgICAgICAgbWluaW9ucz1taW5pb25zLAotICAgICAgICAgICAgICAgICMg
YWx3YXlzIGFjY2VwdCBmaW5kX2pvYgotICAgICAgICAgICAgICAgIHdoaXRlbGlzdD1bJ3NhbHR1
dGlsLmZpbmRfam9iJ10sCi0gICAgICAgICAgICApCi0KLSAgICAgICAgICAgIGlmIG5vdCBhdXRo
b3JpemVkOgotICAgICAgICAgICAgICAgICMgQXV0aG9yaXphdGlvbiBlcnJvciBvY2N1cnJlZC4g
TG9nIHdhcm5pbmcgYW5kIGRvIG5vdCBjb250aW51ZS4KLSAgICAgICAgICAgICAgICBsb2cud2Fy
bmluZyhlcnJfbXNnKQotICAgICAgICAgICAgICAgIHJldHVybiB7J2Vycm9yJzogeyduYW1lJzog
J0F1dGhvcml6YXRpb25FcnJvcicsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
J21lc3NhZ2UnOiAnQXV0aG9yaXphdGlvbiBlcnJvciBvY2N1cnJlZC4nfX0KLQotICAgICAgICAg
ICAgIyBQZXJmb3JtIHNvbWUgc3BlY2lmaWMgYXV0aF90eXBlIHRhc2tzIGFmdGVyIHRoZSBhdXRo
b3JpemF0aW9uIGNoZWNrCi0gICAgICAgICAgICBpZiBhdXRoX3R5cGUgPT0gJ3Rva2VuJzoKLSAg
ICAgICAgICAgICAgICB1c2VybmFtZSA9IGF1dGhfY2hlY2suZ2V0KCd1c2VybmFtZScpCi0gICAg
ICAgICAgICAgICAgbG9hZFsndXNlciddID0gdXNlcm5hbWUKLSAgICAgICAgICAgICAgICBsb2cu
ZGVidWcoJ01pbmlvbiB0b2tlbml6ZWQgdXNlciA9ICIlcyInLCB1c2VybmFtZSkKLSAgICAgICAg
ICAgIGVsaWYgYXV0aF90eXBlID09ICdlYXV0aCc6Ci0gICAgICAgICAgICAgICAgIyBUaGUgdXNl
cm5hbWUgd2UgYXJlIGF0dGVtcHRpbmcgdG8gYXV0aCB3aXRoCi0gICAgICAgICAgICAgICAgbG9h
ZFsndXNlciddID0gc2VsZi5sb2FkYXV0aC5sb2FkX25hbWUoZXh0cmEpCi0KKyAgICAgICAgICAg
ICAgICBsb2FkLmdldCgndGd0X3R5cGUnLCAnZ2xvYicpCisgICAgICAgICAgICAgICAgKQogICAg
ICAgICAjIElmIHdlIG9yZGVyIG1hc3RlcnMgKHZpYSBhIHN5bmRpYyksIGRvbid0IHNob3J0IGNp
cmN1aXQgaWYgbm8gbWluaW9ucwogICAgICAgICAjIGFyZSBmb3VuZAogICAgICAgICBpZiBub3Qg
c2VsZi5vcHRzLmdldCgnb3JkZXJfbWFzdGVycycpOgpAQCAtMTI5MiwxNSArMTU1NSwxMyBAQCBj
bGFzcyBMb2NhbEZ1bmNzKG9iamVjdCk6CiAgICAgICAgICAgICAgICAgJ3RndCc6IGxvYWRbJ3Rn
dCddLAogICAgICAgICAgICAgICAgICd1c2VyJzogbG9hZFsndXNlciddLAogICAgICAgICAgICAg
ICAgICdmdW4nOiBsb2FkWydmdW4nXSwKLSAgICAgICAgICAgICAgICAnYXJnJzogc2FsdC51dGls
cy5hcmdzLnBhcnNlX2lucHV0KAotICAgICAgICAgICAgICAgICAgICBsb2FkWydhcmcnXSwKLSAg
ICAgICAgICAgICAgICAgICAgbm9fcGFyc2U9bG9hZC5nZXQoJ25vX3BhcnNlJywgW10pKSwKKyAg
ICAgICAgICAgICAgICAnYXJnJzogbG9hZFsnYXJnJ10sCiAgICAgICAgICAgICAgICAgJ21pbmlv
bnMnOiBtaW5pb25zLAogICAgICAgICAgICAgfQogCiAgICAgICAgICMgQW5ub3VuY2UgdGhlIGpv
YiBvbiB0aGUgZXZlbnQgYnVzCiAgICAgICAgIHNlbGYuZXZlbnQuZmlyZV9ldmVudChuZXdfam9i
X2xvYWQsICduZXdfam9iJykgICMgb2xkIGR1cCBldmVudAotICAgICAgICBzZWxmLmV2ZW50LmZp
cmVfZXZlbnQobmV3X2pvYl9sb2FkLCBzYWx0LnV0aWxzLmV2ZW50LnRhZ2lmeShbbG9hZFsnamlk
J10sICduZXcnXSwgJ2pvYicpKQorICAgICAgICBzZWxmLmV2ZW50LmZpcmVfZXZlbnQobmV3X2pv
Yl9sb2FkLCB0YWdpZnkoW2xvYWRbJ2ppZCddLCAnbmV3J10sICdqb2InKSkKIAogICAgICAgICAj
IFNhdmUgdGhlIGludm9jYXRpb24gaW5mb3JtYXRpb24KICAgICAgICAgaWYgc2VsZi5vcHRzWydl
eHRfam9iX2NhY2hlJ106CkBAIC0xMzEwLDEyICsxNTcxLDEzIEBAIGNsYXNzIExvY2FsRnVuY3Mo
b2JqZWN0KToKICAgICAgICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgICAgICBs
b2cuY3JpdGljYWwoCiAgICAgICAgICAgICAgICAgICAgICdUaGUgc3BlY2lmaWVkIHJldHVybmVy
IHVzZWQgZm9yIHRoZSBleHRlcm5hbCBqb2IgY2FjaGUgJwotICAgICAgICAgICAgICAgICAgICAn
IiVzIiBkb2VzIG5vdCBoYXZlIGEgc2F2ZV9sb2FkIGZ1bmN0aW9uIScsCi0gICAgICAgICAgICAg
ICAgICAgIHNlbGYub3B0c1snZXh0X2pvYl9jYWNoZSddCisgICAgICAgICAgICAgICAgICAgICci
ezB9IiBkb2VzIG5vdCBoYXZlIGEgc2F2ZV9sb2FkIGZ1bmN0aW9uIScuZm9ybWF0KAorICAgICAg
ICAgICAgICAgICAgICAgICAgc2VsZi5vcHRzWydleHRfam9iX2NhY2hlJ10KKyAgICAgICAgICAg
ICAgICAgICAgKQogICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRp
b246CiAgICAgICAgICAgICAgICAgbG9nLmNyaXRpY2FsKAotICAgICAgICAgICAgICAgICAgICAn
VGhlIHNwZWNpZmllZCByZXR1cm5lciB0aHJldyBhIHN0YWNrIHRyYWNlOicsCisgICAgICAgICAg
ICAgICAgICAgICdUaGUgc3BlY2lmaWVkIHJldHVybmVyIHRocmV3IGEgc3RhY2sgdHJhY2U6XG4n
LAogICAgICAgICAgICAgICAgICAgICBleGNfaW5mbz1UcnVlCiAgICAgICAgICAgICAgICAgKQog
CkBAIC0xMzI2LDEyICsxNTg4LDEzIEBAIGNsYXNzIExvY2FsRnVuY3Mob2JqZWN0KToKICAgICAg
ICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgbG9nLmNyaXRpY2FsKAogICAgICAgICAg
ICAgICAgICdUaGUgc3BlY2lmaWVkIHJldHVybmVyIHVzZWQgZm9yIHRoZSBtYXN0ZXIgam9iIGNh
Y2hlICcKLSAgICAgICAgICAgICAgICAnIiVzIiBkb2VzIG5vdCBoYXZlIGEgc2F2ZV9sb2FkIGZ1
bmN0aW9uIScsCi0gICAgICAgICAgICAgICAgc2VsZi5vcHRzWydtYXN0ZXJfam9iX2NhY2hlJ10K
KyAgICAgICAgICAgICAgICAnInswfSIgZG9lcyBub3QgaGF2ZSBhIHNhdmVfbG9hZCBmdW5jdGlv
biEnLmZvcm1hdCgKKyAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRzWydtYXN0ZXJfam9iX2Nh
Y2hlJ10KKyAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICApCiAgICAgICAgIGV4Y2VwdCBF
eGNlcHRpb246CiAgICAgICAgICAgICBsb2cuY3JpdGljYWwoCi0gICAgICAgICAgICAgICAgJ1Ro
ZSBzcGVjaWZpZWQgcmV0dXJuZXIgdGhyZXcgYSBzdGFjayB0cmFjZTonLAorICAgICAgICAgICAg
ICAgICdUaGUgc3BlY2lmaWVkIHJldHVybmVyIHRocmV3IGEgc3RhY2sgdHJhY2U6XG4nLAogICAg
ICAgICAgICAgICAgIGV4Y19pbmZvPVRydWUKICAgICAgICAgICAgICkKICAgICAgICAgIyBBbHRl
cmluZyB0aGUgY29udGVudHMgb2YgdGhlIHB1Ymxpc2ggbG9hZCBpcyBzZXJpb3VzISEgQ2hhbmdl
cyBoZXJlCkBAIC0xMzQ0LDkgKzE2MDcsNyBAQCBjbGFzcyBMb2NhbEZ1bmNzKG9iamVjdCk6CiAg
ICAgICAgICMgd2F5IHRoYXQgd29uJ3QgaGF2ZSBhIG5lZ2F0aXZlIGltcGFjdC4KICAgICAgICAg
cHViX2xvYWQgPSB7CiAgICAgICAgICAgICAnZnVuJzogbG9hZFsnZnVuJ10sCi0gICAgICAgICAg
ICAnYXJnJzogc2FsdC51dGlscy5hcmdzLnBhcnNlX2lucHV0KAotICAgICAgICAgICAgICAgIGxv
YWRbJ2FyZyddLAotICAgICAgICAgICAgICAgIG5vX3BhcnNlPWxvYWQuZ2V0KCdub19wYXJzZScs
IFtdKSksCisgICAgICAgICAgICAnYXJnJzogbG9hZFsnYXJnJ10sCiAgICAgICAgICAgICAndGd0
JzogbG9hZFsndGd0J10sCiAgICAgICAgICAgICAnamlkJzogbG9hZFsnamlkJ10sCiAgICAgICAg
ICAgICAncmV0JzogbG9hZFsncmV0J10sCkBAIC0xMzcxLDE2ICsxNjMyLDE4IEBAIGNsYXNzIExv
Y2FsRnVuY3Mob2JqZWN0KToKIAogICAgICAgICBpZiAndXNlcicgaW4gbG9hZDoKICAgICAgICAg
ICAgIGxvZy5pbmZvKAotICAgICAgICAgICAgICAgICdVc2VyICVzIFB1Ymxpc2hlZCBjb21tYW5k
ICVzIHdpdGggamlkICVzJywKLSAgICAgICAgICAgICAgICBsb2FkWyd1c2VyJ10sIGxvYWRbJ2Z1
biddLCBsb2FkWydqaWQnXQorICAgICAgICAgICAgICAgICdVc2VyIHt1c2VyfSBQdWJsaXNoZWQg
Y29tbWFuZCB7ZnVufSB3aXRoIGppZCB7amlkfScuZm9ybWF0KAorICAgICAgICAgICAgICAgICAg
ICAqKmxvYWQKKyAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICApCiAgICAgICAgICAgICBw
dWJfbG9hZFsndXNlciddID0gbG9hZFsndXNlciddCiAgICAgICAgIGVsc2U6CiAgICAgICAgICAg
ICBsb2cuaW5mbygKLSAgICAgICAgICAgICAgICAnUHVibGlzaGVkIGNvbW1hbmQgJXMgd2l0aCBq
aWQgJXMnLAotICAgICAgICAgICAgICAgIGxvYWRbJ2Z1biddLCBsb2FkWydqaWQnXQorICAgICAg
ICAgICAgICAgICdQdWJsaXNoZWQgY29tbWFuZCB7ZnVufSB3aXRoIGppZCB7amlkfScuZm9ybWF0
KAorICAgICAgICAgICAgICAgICAgICAqKmxvYWQKKyAgICAgICAgICAgICAgICApCiAgICAgICAg
ICAgICApCi0gICAgICAgIGxvZy5kZWJ1ZygnUHVibGlzaGVkIGNvbW1hbmQgZGV0YWlscyAlcycs
IHB1Yl9sb2FkKQorICAgICAgICBsb2cuZGVidWcoJ1B1Ymxpc2hlZCBjb21tYW5kIGRldGFpbHMg
ezB9Jy5mb3JtYXQocHViX2xvYWQpKQogCiAgICAgICAgIHJldHVybiB7J3JldCc6IHsKICAgICAg
ICAgICAgICAgICAgICAgJ2ppZCc6IGxvYWRbJ2ppZCddLApAQCAtMTM4OCwxOCArMTY1MSwzIEBA
IGNsYXNzIExvY2FsRnVuY3Mob2JqZWN0KToKICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAg
ICAgICAgICAgICAncHViJzogcHViX2xvYWQKICAgICAgICAgICAgICAgICB9Ci0KLSAgICBkZWYg
X3ByZXBfYXV0aF9pbmZvKHNlbGYsIGxvYWQpOgotICAgICAgICBrZXkgPSBOb25lCi0gICAgICAg
IGlmICd0b2tlbicgaW4gbG9hZDoKLSAgICAgICAgICAgIGF1dGhfdHlwZSA9ICd0b2tlbicKLSAg
ICAgICAgICAgIGVycl9uYW1lID0gJ1Rva2VuQXV0aGVudGljYXRpb25FcnJvcicKLSAgICAgICAg
ZWxpZiAnZWF1dGgnIGluIGxvYWQ6Ci0gICAgICAgICAgICBhdXRoX3R5cGUgPSAnZWF1dGgnCi0g
ICAgICAgICAgICBlcnJfbmFtZSA9ICdFYXV0aEF1dGhlbnRpY2F0aW9uRXJyb3InCi0gICAgICAg
IGVsc2U6Ci0gICAgICAgICAgICBhdXRoX3R5cGUgPSAndXNlcicKLSAgICAgICAgICAgIGVycl9u
YW1lID0gJ1VzZXJBdXRoZW50aWNhdGlvbkVycm9yJwotICAgICAgICAgICAga2V5ID0gc2VsZi5r
ZXkKLQotICAgICAgICByZXR1cm4gYXV0aF90eXBlLCBlcnJfbmFtZSwga2V5Cg==
